\documentclass[12pt,draftcls,peerreview,onecolumn]{IEEEtran}
%\documentclass[10pt,conference,twocolumn]{IEEEtran}
%\documentclass[10pt,conference]{IEEEtran}
\usepackage{epsf}
\usepackage{amsmath,amssymb}
\usepackage{graphicx}
\usepackage{color}
\usepackage{cite}
\usepackage{multirow,tabularx}
\usepackage{ifthen}
% Add these after the document class declaration
\usepackage{times}
\usepackage{stackrel}
%\usepackage{hyperref}

\graphicspath{{./plots/}}
%\input{epsf.sty}
%\pagestyle{bfheadings}
%-------------------------------

%\input{commands.tex}

\renewcommand{\baselinestretch}{1.65}
\newcommand{\showfigure}{\boolean{true}}
%\newcommand{\showfigure}{\boolean{false}}

\newcommand{\hide}[1]{\ifthenelse{\boolean{false}}{#1}{}}

%\include{../../commonHeader}
%%%%%%%%%%%%%%%%%%%%%%
% Theorems, etc.

\newtheorem{theorem}{{\bf Theorem}}
\newtheorem{lemma}{{\bf Lemma}}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}{{\bf Corollary}}

%\newenvironment{proof}[1][Proof]{\begin{trivlist}
%\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}

%\newtheorem{defn}{Definition}
\newenvironment{definition}[1][Definition]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}

\newenvironment{example}[1][Example]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}

\newenvironment{remark}[1][Remark]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}

\newcommand{\qed}{\nobreak \ifvmode \relax \else
      \ifdim\lastskip<1.5em \hskip-\lastskip
      \hskip1.5em plus0em minus0.5em \fi \nobreak
      \vrule height0.75em width0.5em depth0.25em\fi}


\newtheorem{fact}{Fact}
\newtheorem{obs}{Observation}

%%%%%%%%%%%%%%%%%%%%%%
% Environments

\newcommand{\barr}{\begin{array}}
\newcommand{\earr}{\end{array}}



%%%%%%%%%%%%%%%%%%%%%%
% References

\newcommand{\eqn}[1]{(\ref{#1})}

%%%%%%%%%%%%%%%%%%%%%%
% Brackets

\newcommand{\brac}[1]{\left({#1}\right)}
\newcommand{\sbrac}[1]{\left[{#1}\right]}
\newcommand{\cbrac}[1]{\left\{{#1}\right\}}

\newcommand{\floor}[1]{\left\lfloor{#1}\right\rfloor}

%%%%%%%%%%%%%%%%%%%%%%
% Misc

\newcommand{\expc}[2][]{E_{#1}\left[{#2}\right]}

\newcommand{\set}[1]{\{#1\}}

\newcommand{\ul}{\underline}
\newcommand{\smq}[1]{{\it #1}}
\newcommand{\ave}[1]{\overline{#1}}

\newcommand{\recip}[1]{\frac{1}{{#1}}}

%%%%%%%%%%%%%%%%%%%%%%
% Indicator function

\newcommand{\indic}[1]{I_{\cbrac{#1}}}

%%%%%%%%%%%%%%%%%%%%%%
% Superscripts
\newcommand{\supth}{^{{\mathrm{th}}}}
\newcommand{\mth}{^{{\mathrm{th}}}}
\newcommand{\supnd}{^{{\mathrm{nd}}}}
\newcommand{\suprd}{^{{\mathrm{rd}}}}


%%%%%%%%%%%%%%%%%%%%%%
% Combinatorics

\newcommand{\nchoosek}[2]{\left(\begin{array}{c}
                                {#1} \\ {#2}
                             \end{array}
                        \right)}

%%%%%%%%%%%%%%%%%%%%%%
% Symbols
\newcommand{\CN}{{\cal CN}}
\newcommand{\db}{{\mathrm dB}}
\newcommand{\Om}{\widehat{\Omega}}

\newcommand{\define}{\triangleq}
%\newcommand{\define}{\stackrel{\triangle}{=}}
%\newcommand{\implies}{\Rightarrow}
%\newcommand{\tendsto}{\rightarrow}
\newcommand{\tendsto}{\to}

\newcommand{\degree}{^{\circ}}
\newcommand{\kroneck}{\otimes}

%%%%%%%%%%%%%%%%%%%%%%
% Special phrases

\newcommand{\ie}{{i.e.}}
\newcommand{\eg}{{e.g.}}
\newcommand{\etal}{{et al.}}
\newcommand{\wrt}{w.r.t.}
\newcommand{\vs}{{vs.}}

%%%%%%%%%%%%%%%%%%%%%%
% Matrix related

\newcommand{\tvec}{\text{vec}} % \vec is already defined
\newcommand{\mtx}[1]{{\bf #1}} % matrix
\newcommand{\mtxg}[1]{{\boldsymbol #1}} % matrix for greek symbol

\newcommand{\trp}{\text{T}} % transpose
\newcommand{\trc}[1]{\text{Tr}\left\{{#1}\right\}} % trace

%%%%%%%%%%%%%%%%%%%%%%
% Special matrices


\newcommand{\mzero}{\mtx{0}}

%%%%%%%%%%%%%%%%%%%%%%
% Principal sub-matrix

\newcommand{\princ}[2]{{#2}^{({#1})}}
\newcommand{\princsup}[3]{{{#2}^{({#1})^{#3}}}}

%%%%%%%%%%%%%%%%%%%%%%
% Probability related

\newcommand{\EX}{\bf{E}} % expectation operator
\newcommand{\expect}[1]{{\bf{E}}\left[{#1}\right]}
\newcommand{\expectpow}[2]{{\bf{E}}^{#2}\left[{#1}\right]}
\newcommand{\explow}[2]{{\bf{E}}_{#1}\left[{#2}\right]}
\newcommand{\prob}[1]{\text{Pr}\brac{#1}}
\newcommand{\pr}{{\text{Pr}}}

%%%%%%%%%%%%%%%%%%%%%%
% Derivatives

\newcommand{\deriv}[2]{\frac{d{#1}}{d{#2}}}
\newcommand{\pderiv}[2]{\frac{\partial{#1}}{\partial{#2}}}

%%%%%%%%%%%%%%%%%%%%%%
% Slides

\newcommand{\bsp}{\begin{slide*}}
\newcommand{\esp}{\end{slide*}}
\newcommand{\bsl}{\begin{slide}}
\newcommand{\esl}{\end{slide}}
\newcommand{\vsp}[1]{\vspace{#1}}





%-------------------------------
% This paper's specific shortcuts

\newcommand{\nbm}[1]{{[\bf nbm: #1]}}
\newcommand{\vinod}[1]{[\textsl{v: #1}]}
\newcommand{\var}[1]{{\bf var}\left[{#1}\right]}
\newcommand{\opt}{\text{opt}}
\newcommand{\sth}{\text{th}}

\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
%\newcommand{\var}{var}

\newcommand{\dv}{D}
\newcommand{\newdv}{{\cal D}^{\prime}}

\newcommand{\abs}[1]{\left\lvert{#1}\right\lvert}

%\newcommand{\err}{\text{Err}}

\newcommand{\given}{\arrowvert}
\newcommand{\givens}{\big\arrowvert}
\newcommand{\Given}{\Big\arrowvert}

\newcommand{\bMQAM}{b_{\text{QAM}}}
\newcommand{\bMPSK}{b_{\text{PSK}}}

\newcommand{\cMPSK}{c_{\text{PSK}}}
\newcommand{\cMQAM}{c_{\text{QAM}}}

%\newcommand{\opt}{\text{opt}}
%\newcommand{\asym}{\text{asm}}


%\newcommand{\err}{\text{Err}}


%% \newcommand{\alphaoptasm}{\alpha_{\opt}^{\asym}}
%% \newcommand{\betaoptasm}{\beta_{\opt}^{\asym}}


%\newcommand{\sepMPSK}{P_{\text{MPSK}}}

\newcommand{\limgamma}{\lim_{\gamma \tendsto \infty}}


\newcommand{\SEP}{\text{SEP}}
\newcommand{\SEPdouble}{\text{SEP}_{\text{si}}}


\newcommand{\sinpiM}{\sin^2\brac{\frac{\pi}{M}}}

\IEEEoverridecommandlockouts
\newcommand{\ceil}[1]{\left\lceil{#1}\right\rceil}

\newcommand{\est}[1]{\widehat{#1}}

\newcommand{\y}{\mathbf{y}}


\newcommand{\hg}{\mathbf{hg}}
\newcommand{\nx}{{0}}
%\newcommand{\nck}[2]{{{#1}\choose{#2}}}
\newcommand{\nck}[2]{\binom{#1}{#2}}
\newcommand{\setAk}{A_{k}}
\newcommand{\setB}{B_1}


\newcommand{\setBhat}{\widehat{B}_1}

%\newcommand{\setAone}{\!\gk{1}\!>\!\taubypt,\setB\!}
\newcommand{\setAgt}{A_1}
\newcommand{\setAlt}{A_2}

\newcommand{\setAgthat}{\widehat{A}_1}
\newcommand{\setAlthat}{\widehat{A}_2}

\newcommand{\setBgk}{B_{gk}}
\newcommand{\setBlk}{B_{lk}}


\newcommand{\snh}{\sin^2(\theta)} 
\newcommand{\onebysin}{\frac{1}{\sin^2(\theta)}} 

\newcommand{\bg}{\frac{\be}{\ga}}
\newcommand{\twobg}{\frac{2\be}{\ga}}
\newcommand{\be}{\alpha}

\newcommand{\ginc}[2]{\gamma\left({#1},{#2}\right)}
\newcommand{\gincnew}[2]{\widetilde{\gamma}\left({#1},{#2}\right)}
\newcommand{\cmc}{\frac{\be}{\ga m^{\bg}}}

\newcommand{\lam}{\lambda}
\newcommand{\lamstar}{\lam^{*}}
\newcommand{\lamp}{\lam_{p}}
\newcommand{\lamasym}{\lam_{\text{a}}}
\newcommand{\lamub}{\lam_{\text{ub}}}
\newcommand{\lsg}{{\lam\mg}}
\newcommand{\s}[1][]{s_{#1}}
\newcommand{\sphi}{s}
%\newcommand{\sphi}{s_{\phi}}

\newcommand{\slam}{s_{\lam}}
\newcommand{\szero}{s_{0}}
\newcommand{\sstar}{s^{*}}
\newcommand{\shp}{s_{h}}
\newcommand{\ipi}{{\frac{1}{\pi}}}
\newcommand{\intmpi}{{\int_{0}^{m\pi}}}
\newcommand{\intm}{{\int_{0}^{m}}}
\newcommand{\intinf}{{\int_{0}^{\infty}}}
\newcommand{\intg}{{\int_{0}^{\frac{m-y_1}{\lam}}}}

\newcommand{\error}{\epsilon_n} 

\newcommand{\mug}{{\mu_{g}}}

\newcommand{\muh}{{\mu_{h}}}

\newcommand{\yg}[1]{y_{#1}+\lam g_{#1}}


\newcommand{\Err}{{\text{Err}}}

\newcommand{\z}{{\cal{Z}}}
\newcommand{\tL}{{L}}
\newcommand{\K}{{\left(1+\frac{\mh}{\eta\mg}\right)}}
\newcommand{\M}{{\left(\frac{\eta\mg}{\eta\mg+\mh}\right)}}
\newcommand{\prlseta}{{\left(\frac{\eta\mg}{\eta\mg+\mh}\right)}}
\newcommand{\frhg}[1]{{\frac{h_{#1}}{g_{#1}}}}
\newcommand{\pdfh}{{\frac{e^{-\frac{h_1}{\mh}}}{\mh}}}
\newcommand{\pdfg}{{\frac{e^{-\frac{g_1}{\mg}}}{\mg}}}\newcommand{\frM}{{\frac{\mg h_1}{\mh g_1+\mg h_1}}}



\newcommand{\MPSKSEP}{\exp\brac{\frac{-h_1\Et\sinpiM}{\sigma^2\sin^2\theta}}}

\newcommand{\F}{\cal{F}}
\newcommand{\goodset}{\cal{G}}
\newcommand{\badset}{\cal{B}}
\newcommand{\setc}{\cal{C}}
\newcommand{\setszero}{{\cal{S}}_0}
\newcommand{\setonegt}{{\cal{S}}_{11}}

\newcommand{\setonelt}{{\cal{S}}_{12}}
\newcommand{\MI}{\text{MI}}
\newcommand{\MSLIR}{\text{MSLIR}}

\newcommand{\termone}{T_1}
\newcommand{\termtwo}{T_2}

\newcommand{\Nt}{{N_t}}
\newcommand{\Nr}{{N_r}}
\newcommand{\Np}{{N_p}}
\newcommand{\Pt}{{P_t}}


\newcommand{\such}{h}
\newcommand{\puch}{g}


\newcommand{\hk}[1]{{\such_{#1}}}
\newcommand{\gk}[1]{{\puch_{#1}}}


\newcommand{\hi}{\hk{i}}
\newcommand{\gi}{\gk{i}}

\newcommand{\hij}{{\such_{ij}}}
\newcommand{\gkj}{{\puch_{kj}}}

\newcommand{\selp}{s_{p}}
\newcommand{\sopt}{s^{*}}

\newcommand{\h}{\mathbf{\such}}
\newcommand{\g}{\mathbf{\puch}}


\newcommand{\ghatvec}{\mathbf{\hat{\puch}}}
\newcommand{\yhatvec}{\mathbf{\hat{y}}}

\newcommand{\Rsrx}{R_{i}}
\newcommand{\Iprx}{I_{p}}
\newcommand{\Isrx}{I_{i}}

\newcommand{\noise}{n_i}

\newcommand{\noisevar}{\sigma^2}

\newcommand{\outsym}{\out_{\text{asym}}}
\newcommand{\outhp}{\out_{{h}}}
\newcommand{\outwb}{\out_{\text{wub}}}
\newcommand{\prout}{\prob{\text{out}}}
\newcommand{\outmax}{O_{\text{max}}}
\newcommand{\itau}{\tau}
\newcommand{\ibeta}{\beta}

\newcommand{\cone}{c_{1}}
\newcommand{\ctwo}{c_{2}}
\newcommand{\cthree}{c_{3}}
\newcommand{\cfour}{c_{4}}

\newcommand{\out}{O}
\newcommand{\m}{\cone}

\newcommand{\outmaxhrule}{e^{-\taubyptmug}}
\newcommand{\taubyptmug}{\frac{\itau}{\mug\Pt}}
\newcommand{\Nttaubyptmug}{\frac{\Nt\itau}{\mug\Pt}}
\newcommand{\taubypt}{\frac{\itau}{\Pt}}
\newcommand{\gkgrtaubypt}[1]{{\gk{#1}}>\taubypt}
\newcommand{\gklttaubypt}[1]{{\gk{#1}}\leq\taubypt}

\newcommand{\gkhatgrtaubypt}[1]{{\gkhat{#1}}>\taubypt}
\newcommand{\gkhatlttaubypt}[1]{{\gkhat{#1}}\leq\taubypt}



\newcommand{\gindic}[1]{\indic{\gkgrtaubypt{#1}}}
\newcommand{\ghatindic}[1]{\indic{\gkhatgrtaubypt{#1}}}

\newcommand{\lambym}{\frac{\lam}{\m}}

\newcommand{\lamstarbym}{\frac{\lamstar}{\m}}


\newcommand{\yk}[1]{y_{#1}}
\newcommand{\ykplambym}[1]{\yk{#1}+\lambym}
\newcommand{\ccdfyray}[1]{\left(1-\left(#1\right)^{\albysnr[]}\right)}
\newcommand{\sepg}[1]{\SEP(\hk{#1}) + \lam \gindic{#1}}
\newcommand{\ykplusgk}[1]{ \yk{#1} + \lambym\gindic{#1}}
\newcommand{\ykhatplusgkhat}[1]{ \ykhat{#1} + \lamstarbym\ghatindic{#1}}
\newcommand{\ccdfg}[1][]{e^{-\frac{{#1}\itau}{\mug\Pt}}}
\newcommand{\inlccdfg}[1][]{\exp\left({-{{#1}\itau}/{\left( \mug\Pt\right) }}\right)}

%\newcommand{\m}{m}
\newcommand{\ai}{a}
\newcommand{\bj}{b}
\newcommand{\cj}{c}
\newcommand{\outopt}{\out_{\text{opt}}}
\newcommand{\lamopt}{\lam_{\text{opt}}}

\newcommand{\inty}{\int_{0}^{1-\lambym}}
\newcommand{\al}{\ctwo}
\newcommand{\snr}{\Omega}
\newcommand{\Ptmuhbynoisevar}{\frac{\Pt\muh}{\noisevar}}
\newcommand{\albysnr}[1][]{\frac{\al#1}{\snr}}
\newcommand{\snrbyal}[1][]{\frac{\snr#1}{\al}}



\newcommand{\un}{U}
\newcommand{\prggrtaubyp}{e^{-\taubyptmug}}
\newcommand{\prggrNttaubyp}{e^{-\Nttaubyptmug}}
\newcommand{\probszero}{\un\left(1-\left(1-\lambym\right)^{\albysnr[]}\right)^{\Nt}}


\newcommand{\allopts}{\left\{\nx,1,\ldots,\Nt\right\}}
\newcommand{\antopts}{\left\{1,2,\ldots,\Nt\right\}}
\newcommand{\twoopts}{\left\{2,\ldots,\Nt\right\}}


\newcommand{\nropts}{\left\{1,2,\ldots,\Nr\right\}}
\newcommand{\puopts}{\left\{1,2,\ldots,\Np\right\}}

\newcommand{\maxh}{{\text{best antenna}}}
\newcommand{\ub}{{\text{UB optimal}}}
\newcommand{\IIC}{{\text{IIC}}}
\newcommand{\iic}{{\text{iic}}}
\newcommand{\EIIC}{{\text{Gamma}}}
\newcommand{\eiic}{{\text{gamma}}}

\newcommand{\mi}{{\text{mi}}}
\newcommand{\mslir}{{\text{mslir}}}
\newcommand{\emi}{\text{emi}}
\newcommand{\emslir}{\text{emslir}}
\newcommand{\interfUncons}{I_{\text{un}}}
\newcommand{\sepUBL}{\SEP^{(\tL)}_{UB}}
\newcommand{\sepUBTwo}{\SEP^{(2)}_{UB}}
\newcommand{\interfUnconsMI}{I_{\text{unmi}}}
\newcommand{\DS}{\text{ds}}
\newcommand{\rBeta}{{\text{Beta}}}
\newcommand{\rbeta}{{\text{beta}}}
\newcommand{\igamma}{{\frac{\al\noisevar}{\Pt}\ln\left(\frac{1}{1-\left(\lam/\m\right) }\right)}}
\newcommand{\igammainline}{{\left( {\al\noisevar}/{\Pt}\right) \ln\left(\frac{1}{1-\left(\lam/\m\right) }\right)}}

\newcommand{\suchph}{\theta}
\newcommand{\puchph}{\varphi}

\newcommand{\thetahk}{\suchph_{is}}
\newcommand{\thetagk}{\puchph_{s}}

\newcommand{\asrule}{\phi}
\newcommand{\asspan}{{\cal A}}
\newcommand{\feasrule}{\phi}
\newcommand{\phiprop}{\phi_{p}}

\newcommand{\psifun}[2]{\psi_{{#1},{#2}}}
%\newcommand{\psifun}[2]{\psi_{k_1k_2}\left({#1},{#2}\right)}

\newcommand{\onemlc}{\left[\!1\!-\!\lamstarbym\!\right]}
%\newcommand{\onemlc}{\left(\!\frac{\cone\!-\!\lam}{\cone}\!\right)}

\newcommand{\thresh}{\beta}
\newcommand{\sg}{s_{\igamma}}
\newcommand{\og}{\out_{\igamma}}

%\newcommand{\zerosep}{\left(1 - \frac{1}{M}\right)}
\newcommand{\zerosep}{m}

\newcommand{\Hmx}{\mtx{H}}
\newcommand{\Gmx}{\mtx{G}}


\newcommand{\ith}{i^{\text{th}}}
\newcommand{\jth}{j^{\text{th}}}
\newcommand{\kth}{k^{\text{th}}}

\newcommand{\optproblem}{{\cal P}}

\newcommand{\caluncons}{{\cal S_{\text{0}}}}
\newcommand{\callamrule}{{\cal S_{{\lam}}}}
\newcommand{\outlam}{\out_{\lam}}
\newcommand{\outhatlam}{\widehat{\out}_{\lam}}
\newcommand{\outhatlamstar}{\widehat{\out}_{\lam^*}}
\newcommand{\outUBlam}{\out_{\text{UB}\lam}}
\newcommand{\outUBtwo}{\out_{\text{UB2}}}
\newcommand{\callamstarrule}{\cal S_{\lam^{*}}}

\newcommand{\calhprule}{{\cal S_{\text{h}}}}

\newcommand{\avgSEP}{\overline{\SEP}}

\newcommand{\akone}{\albysnr[k_1]}
\newcommand{\lidx}{k}

\newcommand{\nullset}{\varnothing}


% imperfect CSI related commands

\newcommand{\sug}{\alpha}
\newcommand{\pug}{\beta}

\newcommand{\sugain}[1]{\sug_{#1}}
\newcommand{\pugain}[1]{\pug_{#1}}

\newcommand{\sugainhat}[1]{\widehat{\sug}_{#1}}
\newcommand{\pugainhat}[1]{\widehat{\pug}_{#1}}

\newcommand{\unhat}{\widehat{\un}}
\newcommand{\snrhat}{\widehat{\snr}}

\newcommand{\gpilotpower}{P_g}
\newcommand{\hpilotpower}{P_h}

\newcommand{\hhat}{\hat{\such}}
\newcommand{\ghat}{\hat{\puch}}
\newcommand{\yhat}{\hat{y}}
\newcommand{\shat}{\hat{s}}

\newcommand{\hkhat}[1]{\hhat_{#1}}
\newcommand{\gkhat}[1]{\ghat_{#1}}
\newcommand{\ykhat}[1]{\hat{y}_{#1}}


\newcommand{\muhhat}{\mu_{\hhat}}
\newcommand{\mughat}{\mu_{\ghat}}

\newcommand{\ccdfghat}[1][]{e^{-\frac{{#1}\itau}{\mughat\Pt}}}
\newcommand{\ccdfghatinline}{\exp\left( {-{\itau}/{\left( \mughat\Pt\right) }}\right) }

\newcommand{\Probglt}{L}

\newcommand{\albysnrhat}[1][]{\frac{\al#1}{\snrhat}}
\newcommand{\snrhatbyal}[1][]{\frac{\snrhat#1}{\al}}

\newcommand{\rhog}{\rho_g}
\newcommand{\rhoh}{\rho_h}

\newcommand{\Tc}{\frac{1}{\snrhatbyal\left(1 + \snrbyal\left(1 - \rhoh \right)  \right) }}

%\newcommand{\Dc}{\frac{1 + \snrbyal}{\snrhatbyal\left(1 + \snrbyal\left(1 - \rhoh \right)  \right) }-1}

\newcommand{\T}{T}
\newcommand{\Dc}{\T \left( 1 + \snrbyal\right) -1}

\newcommand{\hpilotsym}{x_{s}}
\newcommand{\gpilotsym}{x_{p}}

\newcommand{\hpilotrcv}{y_{ik}}
\newcommand{\gpilotrcv}{z_{k}}

\newcommand{\hpilotnoise}{n_{ik}}
\newcommand{\gpilotnoise}{n_{k}}

\newcommand{\ccdfyNr}[1]{\frac{\gamma\left(\Nr,-\albysnr\ln{#1}\right)}{\Gamma\left(Nr\right)}} 
\newcommand{\unccdfy}[2]{\frac{{#1}\,\,\gamma\left(\Nr,-\albysnr\ln{#2}\right)}{\Gamma\left(Nr\right)}}

\newcommand{\pdfyNr}{\frac{\left(\albysnr\right)^{Nr}\left(\ln\left(\frac{1}{x}\right)\right)^{\Nr-1}x^{\albysnr[]-1}}{\Gamma(Nr)}} % only y terms constants taken care separately
\newcommand{\ytimespdfyNr}{\left(\ln\left(\frac{1}{x}\right)\right)^{\Nr-1}x^{\albysnr[]}} % only y terms constants taken care separately
\newcommand{\ypluslamtimespdfyNr}{\left(\ln\left(\frac{1}{x+\lambym}\right)\right)^{\Nr-1}\left(x+\lambym\right)^{\albysnr[]}} % only y terms constants taken care separately


\newcommand{\pdfyNrgen}[1]{f_{y}\left(#1\right)} % only y terms constants taken care separately
\newcommand{\ccdfy}[1]{F^{c}_{y}\left(#1 \right)}
\newcommand{\unccdfygen}[2]{{#1} \ccdfy{#2}  }



\begin{document}

\title{Optimal Transmit Antenna Selection Rule for Interference-Outage Constrained Underlay Cr and Impact
	of Imperfect Csi}
\author{Rimalapudi Sarvendranath, {\it Student Member, IEEE} Neelesh B. Mehta, {\it Senior Member, IEEE}}


\maketitle

\begin{abstract}

\end{abstract}


\begin{IEEEkeywords}
Cognitive radio, underlay, antenna selection, interference-outage constraint, symbol error probability.
\end{IEEEkeywords}

%\IEEEpeerreviewmaketitle



\section{Introduction}
\label{sec:intro}

Cognitive radio (CR) technology has the potential to mitigate the scarcity of radio spectrum by enabling different classes of users to access the spectrum together without an exclusive, strict, inefficient allocation of the spectrum to one class of users~\cite{Haykin_2005_TSAC,vu_2009_TWC}. Owing to its promise, it has been incorporated in IEEE standards such as 802.11af and 802.22~\cite{Sherman_2008_TCMAG}. In CR, a user is classified into two categories: primary user (PU), who is a licensed user of the spectrum, and secondary user (SU), who is an unlicensed user. The following three modes of access have been investigated for SUs~\cite{Goldsmith_2009_PIEEE,Sboui_2013_TWC,RZhang_2009_TWC,XKang_2011_JSAC}: (i)~Interweave mode, in which an SU can only transmit in unused time or frequency resources, (ii)~Overlay mode, in which SU has access to PU's data and channel gains can transmit simultaneously with the PU by allocating some of its resources to relay the PU's information, and (iii)~Underlay mode, in which an SU can transmit concurrently in the same spectrum as the PU, but must ensure that the interference due to its transmissions to the primary receiver (PRx) is below a tolerable limit. 


We focus on the underlay mode in this paper as it enables the SU to transmit even when the primary is on, and as it does not require the SU to know the PU's data and channel gains, unlike the overlay mode. Its performance is fundamentally governed by the constraint imposed on the interference caused to the PRx. Various interference constraints have been investigated in the literature~\cite{Haykin_2005_TSAC}. These include (i)~Peak interference power constraint~\cite{ Hanif_2015_globecom,Wang_2010_TWC, RZhang_2009_TWC}, in which  the instantaneous interference power at the PRx cannot exceed  a threshold; (ii)~Average interference power  constraint~\cite{ Sarvendranath_2013_TCOM,Wang_2011_TCom, Kashyap_2014_TCOM }, in which  the fading-averaged interference power at the PRx  cannot exceed  a threshold; (iii)~Primary signal-to-interference-plus-noise-ratio (SINR) constraint~\cite{Dmochowski_2011_CROWNCOM}, in which the SINR at the PRx cannot fall below a threshold; and (iv)~Interference-outage constraint~\cite{hong_2008_icccas,Kashyap_2014_TCOM,Sboui_2013_TWC,Rezki_2012_ieeeVt}, in which the event that the interference exceeds a certain value is referred to as an interference-outage, and the probability of an interference-outage cannot exceed a threshold.  

These interference constraints can significantly limit the performance of the secondary system. This has spurred the investigation of advanced techniques to improve the secondary system performance while adhering to the interference constraint. Transmit antenna selection (TAS) is an important example of this. It exploits the spatial diversity afforded by multiple antennas while avoiding the hardware complexity of the latter~\cite{molisch_2004_MicrowaveMag,mehta_2012_ComMag}. Only one radio frequency (RF) chain, that is dynamically switched to one of the antennas based on the current channel conditions is required. 

Given its benefits, TAS has attracted considerable attention in the underlay CR literature~\cite{Zhou_2009_WCNC,Dmochowski_2011_CROWNCOM,Wang_2011_TCom,Zhou_2008_IET,Hanif_2015_globecom,Sarvendranath_2013_TCOM,Wang_2010_TWC,Kong_2011_JCN}. Compared to single antenna system, TAS is shown to significantly improve the ergodic capacity of the secondary,~\cite{Hanif_2015_globecom,Wang_2010_TWC}, and reduce the secondary outage probability and outage capacity~\cite{Kong_2011_JCN}, and the symbol error probability (SEP) at the SRx~\cite{Sarvendranath_2013_TCOM}. All these works highlight the fact that in underlay CR, the choice of the antenna is driven not just by the channel gains from it to the secondary receiver's antenna(s), but also by the interference it causes to the PRx. The choice of the antenna also crucially depends on the interference constraint imposed on the secondary system. To understand this better, we discuss the different TAS rules, which specify the antenna to be selected as a function of the instantaneous channel gains, that have been considered in the literature for the different interference constraints. 
%
\begin{itemize}
\item {\em Peak Interference Constraint:} For an STx transmitting with fixed power, in~\cite{Hanif_2015_globecom}, among the antennas that satisfy peak interference constraint, the one with the highest STx to SRx (STx-SRx) channel power gain is selected. It is easy to show that it maximizes the SU capacity, or minimize the SEP. Furthermore, when the STx transmit power is inversely proportional to the STx-PRx channel power gain, the antenna with the highest ratio of the STx-SRx and STx-PRx channel power gains is selected in~\cite{Wang_2010_TWC}. The secondary system outage and capacity of the TAS rule with this constraint are analyzed in~\cite{Kong_2011_JCN,Fakhan_2014_TSP,Asaduzzaman_2010_IET}.
%
\item {\em Average Interference Constraint:} A difference TAS rule is proposed in~\cite{Wang_2011_TCom}. It selects the antenna with a maximum weighted difference of the STx-SRx and STx-PRx channel power gains. For an STx that transmits with fixed power, in~\cite{Sarvendranath_2013_TCOM} an optimal TAS rule that minimizes the average symbol error probability (SEP) is proposed. This rule selects the antenna that minimizes a linear combination of the STx-PRx channel power gain and an exponentially decreasing function of the STx-SRx channel power gain. Furthermore, an average SEP optimal TAS rule is proposed in~\cite{Sarvendranath_2014_TCOM} for an average trasnmit power constrained STx. It selects an antenna   with the highest ratio of STx-SRx channel power gain and an afine combination of a scaled STx-PRx channel power gain and a coonstant. 

%
\item {\em Primary SINR Constraint:} For an STx that adapts its transmit power to ensure that the primary SINR meets a threshold, the antenna that maximizes the product of the STx-SRx channel power gain and its transmit power is selected in~\cite{Dmochowski_2011_CROWNCOM}. However, the STx requires knowledge of the primary transmitter (PTx) to PRx channel power gain.  

\item{\em Interference-Outage Constraint:} To the best of our knowledge, no TAS rule is studied for this constraint and the optimal selection rule is not known in the literature. However ~\cite{Peng_2016_eurasip} analyzed the performance of the TAS rule developed for peak interference power constraint in the presence of imperfect CSI. They considered transmit power back-off to restrict interference-outage caused to the PRx due to imperfect CSI to a certain value.

\end{itemize}

\subsection{Interference-Outage Constraint and Imperfect CSI of STx-PRx Channel }

 
In this paper, we develop the optimal TAS rule for an interference-outage constrained underlay CR. We study this constraint because it is a generalization of the peak interference constraint. The latter corresponds to the extreme case in which the interference-outage probability is forced to be zero. Therefore, studying this constraint leads to a more general class of selection rules. Furthermore, the peak interference constraint requires perfect channel State Information (CSI) of the STx-PRx channel gain at the STx. This is not possible in practice due to the channel estimation errors and outdated estimates~\cite{musavian_2009_tcom}. It is shown that the interference-outage is unavoidable in the presence STx-PRx channel errors and STx has to be off all the time to meet the peak interference power constraint~\cite{musavian_2009_tcom,Suraweera_2010_TVT,Peng_2016_eurasip}. Both~\cite{Suraweera_2010_TVT} and~\cite{Peng_2016_eurasip} used transmit power back off method to limit the interference-outage caused to the PRx. Specifically, in~\cite{Suraweera_2010_TVT} the impact of this imperfect CSI on the average capacity and the average bit error rate is studied for a peak interference power constrained single antenna SU. A similar study is done in~\cite{Peng_2016_eurasip} for an SU which uses TAS at the STx. Further, the effect of imperfect CSI on the effective capacity of the SU with arbitrary TAS rule is studied in~\cite{Li_2011_commLet}. 


In terms of the impact on the primary system this constraint, is justifiable under the scenarios: When primary offers delay or disruption tolerant services, or the primary traffic is based on user datagram protocol (UDP) services like voice and video traffic. Furthermore, the primary wireless systems are designed to tolerate deep-fades or larger co-channel interference-outage. As mentioned above, the TAS rule for it has not been studied in the literature. Further, it cannot be inferred from the TAS rules proposed for other interference constraints. 

\subsection{Contributions} 
We make the following contributions:
\begin{itemize}
\item We first propose a novel TAS rule for an interference-outage constrained underlay CR system, and prove that for a large class of fading models with continuous CDF, it yields the lowest fading-averaged SEP in the class of all TAS rules that satisfy the interference-outage constraint. It is also applicable to many constellations. We note that the average SEP is an important performance measure for a communication system and has attracted significant interest in several of the papers~\cite{Kashyap_2014_TCOM,Sarvendranath_2013_TCOM,li_2011_pimrc}. 
%
\item The optimal TAS rule selects an antenna that minimizes the sum of two terms. The first term is the instantaneous SEP of that antenna and the second term is the indicator function of STx-PRx channel power gain weighted by an interference-outage penalty factor $\lam$. To the best of our knowledge, such a rule has not been proposed in the literature and differs from those in~\cite{Hanif_2015_globecom,Sarvendranath_2013_TCOM,Wang_2011_TCom,Dmochowski_2011_CROWNCOM,Wang_2010_TWC}. It is different from the ones that are designed for the average interference constraint~\cite{Sarvendranath_2013_TCOM,Sarvendranath_2014_TCOM} and primary SINR constraint~\cite{Dmochowski_2011_CROWNCOM}. Further, it includes the TAS rule in~\cite{Hanif_2015_globecom}, that was defined for peak interference constraint. 
 
%It is also different from the one that is designed to meet the peak interference constraint since in it <what happens and is different?>. 
%
\item We then analyze the average SEP of the optimal TAS rule. First, we derive a general expression that is in a single integral form for any fading model with an arbitrary number of antennas at the SRx. we then  simplify it further into an insightful closed-form expression for a range of parameter $\lam$ for Rayleigh fading model and for an SRx with single receive antenna. For this model we also present an integral free tight approximation which works for all values of $\lam$. 
% 
\item We also present results that enable the optimum $\lam$ to be computed easily. For this, we derive a novel integral free upper bound on the interference-outage probability, which further leads to an insightful closed-form and tight upper bound for $\lam$. This is noteworthy because this parameter is typically obtained numerically~\cite{Sarvendranath_2013_TCOM,Wang_2011_TCom}. 
% 
%\item We also show that in high transmit power region the optimal rule transforms into a very simple form. This results in a closed-form exact expression for interference-outage probability.       
%
%\item To gain further insights, we derive a simpler upper bound on the interference-outage probability for the special case with $\Nt = 2$ antennas. Using this we get a very simple closed-form expression for $\lam$. We show that the performance of the optimal TAS rule does not degrade much even when the $\lam$ is chosen from this simple upper bound. Note that the optimization parameter is generally obtained using numerical methods~\cite{Sarvendranath_2013_TCOM,Wang_2011_TCom}.

\item We also study the impact of the imperfect CSI of both the STx-SRx channel power gain and the STx-PRx channel power gain on the optimal TAS rule. Whereas in the CR with TAS literature impact of the imperfect CSI of the STx-PRx channel alone is considered~\cite{musavian_2009_tcom,Suraweera_2010_TVT,Peng_2016_eurasip,Li_2011_commLet}. We derive analytical expressions for the average SEP and the interference-outage probability in the presence of imperfect CSI.

\item We also present extensive simulation results to benchmark the optimal TAS rule with other TAS rules proposed in the literature, bring out its dependence on various system parameters, and verify the analysis.

\end{itemize}

\subsection{Outline and Notation}
The rest of the paper is organized as follows. Section~\ref{sec:model} presents the system model and the problem statement. The optimal TAS rule and its interference-outage probability are given in Section~\ref{sec:analysis}. The SEP analysis and the simplified form of the optimal TAS rule are  in Section~\ref{sec:SEPanalysis}. The impact of the imperfect CSI on the optimal TAS rule is studied in section~\ref{sec:imperfectcsi}. Numerical results in Section~\ref{sec:results} are followed by our conclusions in Section~\ref{sec:conclusions}. Mathematical derivations are relegated to the Appendix.

\emph{Notation:} We use the following notations in this paper. The absolute value of a complex number $x$ is denoted by $|x|$. The probability of an event $A$ and the conditional probability of $A$ given $B$ are denoted by $\prob{A}$ and $\prob{A \given B}$, respectively. For a random variable (RV) $X$, $f_{X}(x)$ denotes its probability density function (PDF), $F_{X}^{c}(x)$ denotes its complementary cumulative distribution function (CCDF), and $\explow{X}{\cdot}$ denotes its expectation. Further, $X \sim {\cal CN}(0,\sigma^2)$ means that $X$ is a circular symmetric complex Gaussian RV with zero mean and variance $\sigma^2$.  Scalar variables are written in normal font and vector variables are written in bold font. $\indic{a}$ denotes the indicator function; it is 1 if $a$ is true and is 0 otherwise. $\nullset$ denotes the null set.

\section{System Model and Problem Statement}
\label{sec:model}
The system model is shown in Figure~\ref{fig:MODEL}. It consists of an STx with $\Nt$ antennas that transmits data to an SRx with $\Nr$ receive antennas and causes interference to a PRx with one antenna. The STx is equipped with only one RF chain. Hence, it dynamically selects one antenna at a time and connects to the available RF chain. For $i \in \nropts$ and $k \in \antopts$, $\hk{ik}$ denotes the instantaneous channel power gain from $\kth$ transmit antenna of STx to the $\ith$ receive antenna of the SRx. The instantaneous channel power gain from $\kth$ antenna of the STx to the PRx be $\gk{k}$, for $k \in \antopts$. We assume that all the $\Nt\Nr$ STx-SRx channels are independent and identically distributed (i.i.d.) RVs and so are the $\Nt$ STx-PRx channels to the PRx. This is justified when the antennas are sufficiently spaced apart, and has been assumed in~\cite{Fakhan_2014_TSP,Kong_2011_JCN,Sarvendranath_2013_TCOM,Hanif_2015_globecom}. Let $\Hmx$ denote the STx-SRx channel power gain matrix $\left[\hk{ik}\right]$ and $\g\define\left[\gk{1},\ldots,\gk{\Nt}\right]$ denote the STx-PRx channel power gain vector.



\begin{figure}
\centering 
\includegraphics[width=0.75\columnwidth]{plots/MODEL_NtxNr.eps}
\caption{System model showing a CR system that contains an STx with $\Nt$ transmit antennas and one RF chain. It transmits data to an SRx with $\Nr$ antennas and causes interference to the PRx with one antenna.}
\label{fig:MODEL}
\end{figure}
\newcommand{\hs}{\mathbf{\such}_{s}}
\newcommand{\hsstar}{\mathbf{\such}_{s^{*}}}
\subsection{Selection Options and Data Transmission}
The STx transmits a data symbol $x$ that is drawn with equal probability from a constellation of $M$ symbols. STx can select one out of $\Nt$ antennas and transmits with a fixed power $\Pt$. Further, it can also decide to transmit with none of the antennas, \ie, transmit with zero-power, in order not to interfere with the PRx. We shall denote the transmission with zero-power as transmitting from a virtual antenna $\nx$, and the corresponding channel power gains are defined to be zero, \ie, $\hk{i\nx} \define 0$, for $i\in\nropts$ and $\gk{\nx}\define 0$. Let $s\in\allopts$ denote the antenna selected by the STx. Thus, STx has $\Nt+1$ options to select from. 

Let the signal received and the interference due to PU transmissions seen at the $\ith$ receive antenna of the SRx be $\Rsrx$ and $\Isrx$, respectively. Let the interference seen by the PRx due to SU transmissions be $\Iprx$. Then, $\Rsrx$ and $\Iprx$ are given by
%
\begin{align}
\label{eq:r_su}
 \Rsrx &= \sqrt{\Pt}\sqrt{\hk{is}} e^{j\thetahk}x + \noise + \Isrx, \\
 \label{eq:i}
 \Iprx &= \sqrt{\Pt}\sqrt{\gk{s}} e^{j\thetagk}x ,
\end{align}
%
where $\expect{|x|^2}=1$, $\thetahk$ and $\thetagk$ are the phases of the complex baseband STx-SRx and STx-PRx channel gains, respectively, and $\noise$ is a circular symmetric complex additive white Gaussian RV. We assume $\Isrx$ to be Gaussian. Therefore, $\noise + \Isrx\sim \CN\left(0,\noisevar\right)$. The Gaussian interference assumption at the SRx corresponds to a worst case model and is assumed in the literature to ensure tractability. Its validity depends on the characteristics of the PTx-SRx channel and signal transmitted by the PTx~\cite{Kashyap_2014_TCOM}. This is indeed valid when the interference seen at the SRx is negligible which is assumed in~\cite{Zhou_2008_IET,Zhou_2009_WCNC,musavian_2009_tcom,RZhang_2009_TWC,li_2011_pimrc,Sboui_2013_TWC} and occurs when SRx is located geographically far from the PTx. It is valid even with one PTx, if the PTx uses a constant amplitude signal to communicate with the PRx~\cite{Kashyap_2014_TCOM}. With multiple PTxs, it is justified by the central limit theorem. 

\subsection{CSI Assumptions and Justifications}  
Before we state the problem, we discuss the  CSI assumptions and justifications. 
\begin{enumerate}
\item In order to perform TAS, we assume that the STx knows the STx-SRx channel power gains $\Hmx$, as also has been assumed in~\cite{XKang_2011_JSAC,Hanif_2015_globecom,Sarvendranath_2013_TCOM,Kong_2011_JCN,Asaduzzaman_2010_IET,Kang_2008_ICC,Wang_2010_TWC,RZhang_2009_TWC}. However, it is not required to know the phase information of these channels. When the secondary system operates in time division duplex mode, $\Hmx$ can be obtained at the STx by making use of reciprocity without using any feedback~\cite{Sarvendranath_2013_TCOM}. Alternatively, in frequency division duplexing, feedback from the SRx to STx is required. The SRx uses a coherent demodulator. Hence, it only needs to know the complex channel gains from the selected transmit antenna of the STx to itself, \ie, $\hk{is}$ and $\thetahk$, for $i\in\nropts$. These can be estimated by inserting a pilot symbol along with the data. 

\item We also assume that STx knows STx-PRx channel power gains $\g$, as has been assumed in~\cite{Hanif_2015_globecom,Sarvendranath_2013_TCOM,Kong_2011_JCN,Asaduzzaman_2010_IET,Kang_2008_ICC,Wang_2010_TWC,RZhang_2009_TWC}. Different techniques have been investigated in the literature to acquire $\g$. A technique, in which STx senses the primary signal periodically is discussed in~\cite{Zhao_2008_TSP}. Further, in~\cite{RZhang_2008_DSAN} power-feedback loop technique, which does not require feedback is discussed. Anyhow for the optimal TAS rule proposed, we show that STx can employ simple estimation techniques to obtain $\g$. This is because the optimal TAS rule requires the STx to only know if the interference channel power gain of each antenna exceeds a pre-defined threshold. Obtaining this knowledge is considerably simpler and more robust than knowing the real-valued interference channel power gain. The SRx does not need to know $\g$. 
\end{enumerate}

\subsection{Problem Statement}
We now formally state our problem. Let $\SEP(\hs)$ denote the instantaneous SEP when antenna $s$ is used for transmission, where $\hs\define\left[\hk{1s},\ldots,\hk{\Nr s} \right]$  denote the vector of STx-SRx channel power gains corresponding to the antenna $s$. From~\cite[(14)]{Chung_2001_TCom}, it is given by  
\begin{equation}
\SEP(\hs) \approx \cone \exp\left({-\frac{\Pt\sum_{i=1}^{\Nr}\hk{is}}{\ctwo\noisevar} }\right), \quad\text{for} \quad 0\leq s \leq \Nt,
\label{eq:isep}
\end{equation} 
where $\cone$ and $\ctwo$ are modulation specific constants. For example, $(\cone,\ctwo )=(0.5,1.7)$ for QPSk,  $(\cone,\ctwo)=(0.6,5.5)$ for 8-PSK, and  $(\cone,\ctwo )=(0.8,8.2)$ for 16-QAM. The summation term in~\eqref{eq:isep} arises as the SRx employs MRC. This formula is exact for differential binary phase-shift-keying (DBPSK) with ($\cone$,~$\ctwo$) = (0.5,~1)  and non-coherent binary frequency-shift-keying (NCBFSK) with  ($\cone$,~$\ctwo$) = (0.5,~2)~\cite{Fakhan_2014_TSP}. This general formula is also applicable for several other constellations such as differential PSK (DPSK) and M-ary frequency-shift-keying (MFSK)~\cite{simon_alouini_book}. 


{\em Comments:}
\begin{itemize}
\item We note that~\eqref{eq:isep} is an approximation for some constellations. However, it applies to a large number of constellations and is tractable. We also note that when antenna zero is selected, $\SEP(\hk{\nx})$ tends to  $\cone$,  For the purpose of designing the TAS rule, we will use this formula for all antennas, including $s=\nx$. However, in the average SEP analysis, we will use the accurate value of the SEP defined below for $s=\nx$ as well.
\item {\em Exact Zero-Transmit Power SEP:} Even with zero-transmit power ($s=\nx$), the STx transmits a symbol which the SRx can detect correctly with probability $\frac{1}{M}$. Thus, the SEP for $s=\nx$ is equal to $\zerosep \define 1 - \frac{1}{M}$. It is important that such a penalty be associated with $s=\nx$ to ensure that the optimal TAS rule does not select only $s=\nx$ in order to cause less interference~\cite{Kashyap_2014_TCOM,Sarvendranath_2013_TCOM}. 	
\end{itemize}


From~\eqref{eq:i}, the instantaneous interference power at the PRx is $\Pt\gk{s}$.\footnote{The interference power is effectively averaged over the different symbols in a constellation.} Therefore, the probability that it exceeds an interference power threshold $\itau$ is equal to $\prob{\Pt\gk{s}>\itau}$. Note that this probability depends on the selection rule used through $s$. Then, the interference-outage probability constraint can be specified as 
\begin{equation}
\prob{\Pt\gk{s}>\itau} \leq \outmax,
\label{eq:iop_cons}
\end{equation}
where $\outmax$ is the maximum interference-outage probability that can be allowed. We now define the TAS rule below.

{\em TAS Rule Definition:} A TAS rule $\asrule:\brac{\mathbb{R}^{+}}^{\Nr}\times\brac{\mathbb{R}^{+}}^{\Nt} \times \brac{\mathbb{R}^{+}}^{\Nt} \rightarrow \allopts$ is a mapping from $\left(\Hmx,\g\right)$ to the set of $\Nt+1$ available transmit antennas. 

Let $\asspan$ be the span of all such mappings. Let $s$ be the antenna selected by the TAS rule $\asrule$. Our goal is to find the optimal TAS rule $\phi^{*}$ that minimizes the average SEP of the secondary system under the interference-outage probability constraint in~\eqref{eq:iop_cons}. This can be mathematically stated as the  following stochastically constrained optimization problem:
\begin{align}
\optproblem: \quad \min_{\asrule\,\in\,\asspan} \quad &\explow{\Hmx,\g}{\SEP(\hs)} \\
\label{eq:objective}
\text{s.t.} \quad &\prob{\Pt\gk{s}>\itau} \leq \outmax, \\
 &s = \phi(\Hmx,\g). 
\end{align}



\section{Optimal TAS Rule and Its Interference-Outage Probability}
\label{sec:analysis}

In this section, we first propose a new TAS rule called the lambda-weighted interference indicator rule and characterize some of its properties. We use them to prove that it is indeed the solution to the problem $\optproblem$ above for a general class of fading models. We then analyze its interference-outage probability and average SEP for Rayleigh fading. We also gain insights by showing that it simplifies considerably in the high transmit power regime and that interference-outage penalty factor $\lam$ can be written in closed-form in this asymptotic regime.

\subsection{$\lam$-Weighted Interference Indicator Rule}
\label{sec:lambda_rule}
Let 
\begin{equation}
\yk{k} \define  \exp\left({- \frac{\Pt\sum_{i=1}^{\Nr}\hk{ik}}{\ctwo\noisevar} }\right), \quad \text{for} \quad 0\leq k \leq\Nt,
\label{eq:yi_def}
\end{equation}
and let $\y \define [\yk{1},\ldots,\yk{\Nt}]$. We define the following parametric TAS rule $\callamrule$, which we shall call as the {\em $\lam$-weighted interference indicator} rule. It is defined in terms of a parameter $\lam \in \left[0, \cone\right]$.
\begin{equation}
\callamrule: \quad\slam=\argmin\limits_{k\in\allopts} \left\{ \ykplusgk{k} \right\}.
\label{eq:lam_weight_rule}
\end{equation}

To understand the behavior of $\callamrule$, we introduce the following terminology. We shall refer to 
%\begin{equation}
$\ykplusgk{k}$
%\label{eq:metric}
%\end{equation}
as the {\em selection metric} of the transmit antenna $k$, for $0\leq k \leq\Nt$. Thus, this rule selects the antenna with the lowest selection metric. Further, we shall refer to an antenna $k$ for which $\gklttaubypt{k}$ as an {\em outage-compatible} antenna. Otherwise, we shall refer to it as an {\em outage-incompatible} antenna.  Clearly, antenna zero is always outage-compatible and its selection metric is $\yk{0}=1$. We now explain how $\callamrule$ behaves for different values of $\lam$.

\newcommand{\sumnr}{\sum_{i=1}^{\Nr}}
{\em Comments:}
\begin{enumerate}
\item For $\lam=0$, the selection metric of antenna $k$ is $\yk{k}$. As $\hk{ik}\geq 0$, it follows from~\eqref{eq:yi_def} that $\yk{0}=1\geq\yk{1},\ldots,\yk{0}\geq\yk{\Nt}$. Furthermore, $\yk{1},\ldots,\yk{\Nt}$ are monotonically decreasing functions of $\sumnr\hk{ik}$. Hence, 
\begin{equation}
\caluncons:\quad s=\!\!\!\argmin\limits_{k\in\allopts}\!\! \left\{ \yk{k} \right\} = \!\!\!\argmin\limits_{k\in\antopts}\!\! \left\{ \yk{k} \right\} = \!\!\!\argmax\limits_{k\in\antopts}\!\! \left\{\sumnr \hk{ik} \right\}.
\label{eq:uncons_simple}
\end{equation}

From~\eqref{eq:isep} and~\eqref{eq:objective}, $\caluncons$ is clearly the optimal TAS rule if the interference-outage constraint in~\eqref{eq:iop_cons} is not present, \ie, when $\outmax=1$. We shall, therefore, refer to $\caluncons$ as the {\em interference unconstrained} rule henceforth. Its interference-outage probability is given by
%
\begin{equation}
\un= \prob{\gk{s}>\taubypt}=\prob{\gk{1}>\taubypt}.
\label{eq:uncomsoutage}
\end{equation}
%
The second equality above follows because the antenna $s$ selected by $\caluncons$ does not depend on $\gk{s}$, and $\gk{1},\ldots,\gk{\Nt}$ are i.i.d. 

\item For $0<\lam<\cone$, the selection metric of antenna $k$ is a linear combination of  an exponentially decreasing function of $\sumnr\hk{ik}$ and $\indic{\gkgrtaubypt{k}}$, which is a discontinuous function of $\gk{k}$. A three-dimensional view of this selection metric as a function of $\sumnr\hk{ik}$ and $\gk{k}$ is shown in Figure~\ref{fig:metric}. Notice its discontinuous behavior, which happens when $\gk{k}=\taubypt$. 

\item For $\lam=\cone$, the selection metric of any outage-incompatible antenna is greater than one, which is the selection metric of antenna zero. Hence, an antenna that is outage-incompatible will not be selected. This means that the $\lam$-weighted indicator rule will select an antenna with the highest $\sumnr\hk{ik}$ from the set of outage-compatible antennas. In such a case it is equivalent to the optimal rule for the peak interference constraint, \ie, when $\outmax=0$.

%\item A necessary but not sufficient condition for virtual antenna zero to be selected is that all the $\Nt$ antennas $1,\ldots,\Nt$ are outage-incompatible. This is because the selection metric of any outage-compatible antenna $i$, for $1\le i \leq \Nt$, is less than that of antenna zero, \ie, $\yk{i}<\yk{0}$.

\end{enumerate}

\begin{figure}
\centering 
\includegraphics[width=\linewidth]{plots/selection_metric_3d.eps}
\caption{Metric of antenna $k$ as a function $\sumnr\hk{ik}$ and $\gk{k}$.}
\label{fig:metric}
\end{figure}

\subsection{Optimal TAS Rule}
We first derive the interference-outage probability of $\callamrule$ in terms of the CDF of $\yk{i}$. Since $\yk{1},\ldots,\yk{\Nt}$ are i.i.d., we denote their CCDF and PDF by $F_{y}^{c}(\cdot)$ and $f_{y}(\cdot)$, respectively. 
\begin{lemma}
\label{lem:outage_Nt}
The interference-outage probability $\outlam$ of $\callamrule$, for $0\leq\lam\leq\cone$ is given by
\begin{equation}
\label{eq:pr_outage_ccdf} 
\outlam  =  \Nt\un \int_{0}^{1-\lambym} 	
\left[ \un F_{y}^{c}\left(x\right) + \left(1 -\un\right)F_{y}^{c}\left(x+\lambym\right) \right]^{\Nt-1} f_{y}(x)\,dx.
\end{equation}
For the class of continuous fading distributions, $\outlam$ is a continuous and strictly monotonically decreasing function of $\lam$. Furthermore, for any $\outmax\in[0,\un]$, a unique $\lam$ exists such that $\outlam=\outmax$. 
\end{lemma}
%
\begin{IEEEproof}
    The proof is given in Appendix~\ref{proof:outage_Nt}.
\end{IEEEproof}
%
%Note that~\eqref{eq:pr_outage_ccdf} reduces to $\un$ when $\lam=0$, which corresponds to the interference unconstrained rule. Further, $\outlam=0$ when $\lam=\cone$, which corresponds to the peak interference constrained rule.  
{\em Insights:} Replacing $x+\lambym$ with $\lambym$ in~\eqref{eq:pr_outage_ccdf}, the following closed-form upper bound for $\outlam$ can be derived: 
\begin{equation}
\label{eq:pr_outage_ub}
\outlam  \leq \left[ \un + \left(1-\un\right)F_{y}^{c}\left(\lambym\right)  \right]^{\Nt} - \left[ \un F_{y}^{c}\left(1-\lambym\right) + \left(1-\un\right)F_{y}^{c}\left(\lambym\right)  \right]^{\Nt}.
\end{equation}
For $\Nt = 2$, the following different, simpler bound can be derived: $\outlam \leq \un^2 + 2\un(1-\un)F_{y}^{c}\left(\lambym\right)$.


Using Lemma~\ref{lem:outage_Nt}, we prove the following key result. 
%
\begin{theorem}
\label{thm:selection_rule_on_off}
The optimal TAS rule lies in the set of rules $\set{\callamrule:0\leq\lam\leq\cone}$. If $\outmax\geq\un$,  then it is given by $\caluncons$. Else, for $0\leq\outmax<\un$, it is given by $\callamstarrule$, where $\lamstar>0$  is the solution of $\outlam=\outmax$. Such a choice of $\lamstar$ is unique, strictly positive, and always exists. 
\end{theorem}
%                
\begin{IEEEproof}
   The proof is given in Appendix~\ref{proof:selection_rule_on_off}.
\end{IEEEproof}
%
Notice that the $\callamstarrule$ only needs to know if the STx-PRx channel power gain exceeds a threshold $\tau/\Pt$. Thus, the exact value is $\gk{i}$ is not required at the STx. This makes the optimal TAS rule robust against the estimation errors of the STx-PRx channel power gain. 

\section{SEP Analysis of the Optimal TAS Rule}
\label{sec:SEPanalysis}
In this section, we derive the average SEP expression for an interference-outage constrained underlay SU when optimal TAS rule is employed. First, we do this for a secondary system with $\Nt$ transmit antennas and $\Nr$ receive antennas for any fading model. Then, we show that this average SEP expression can be simplified to closed-form for Rayleigh fading when $\Nr=1$.

We now derive an expression for the average SEP, which we denote by the $\avgSEP$, of the optimal TAS rule. 
\begin{theorem}
\label{thm:SEP_exact_Nt_gen}
The $\avgSEP$ of the secondary system for the optimal TAS rule $\callamstarrule$ for any fading model is given by
\begin{equation}
\label{eq:SEP_MPSK_Nt_gen} 
\avgSEP= \termone + \termtwo,
\end{equation}
%
where
\begin{align}
\label{eq:termone_gen} 
\termone &=m\left[\unccdfygen{\un}{1-\lamstarbym}\right]^{\Nt},\\
\label{eq:termtwo_gen}
\termtwo \!&= \Nt\m(1-\un)\int_{0}^{\lamstarbym} \left[\un + \unccdfygen{(1-\un)}{x}\right]^{\Nt-1} x\pdfyNrgen{x} dx\nonumber\\
&\quad + \Nt\m \int_{0}^{1-\lamstarbym}
\left[\unccdfygen{(1-\un)}{x+\lamstarbym} + \unccdfygen{\un}{x}\right]^{\Nt-1}\nonumber\\
&\quad\times\left((1-\un)\left(x + \lamstarbym\right) \pdfyNrgen{x + \lamstarbym}+\un x\pdfyNrgen{x}\right) dx ,
\end{align}
%
$\ccdfy{x}$, and $\pdfyNrgen{x}$ are the CCDF and PDF of the i.i.d random variables  $\yk{1},\ldots,\yk{\Nt}$.
\end{theorem}
%
\begin{IEEEproof}
The proof is given in Appendix~\ref{proof:SEP_exact_Nt_gen}.
\end{IEEEproof}
%
Note that the $\termone$ in~\eqref{eq:termone_gen}, which corresponds to the average SEP due to $s=\nx$ increases as the interference outage penalty factor $\lamstar$ increases. This is because higher $\lamstar$ corresponds to tighter interference-outage constraint which increases the probability of selecting $s=\nx$. 
%
%\begin{multline}\label{eq:SEP_Nt_Nr_rayleigh} \frac{\Nt\m(1-\un)}{\Gamma(Nr)}\left(\albysnr\right)^{Nr}\int_{0}^{\lambym} \left(\un + \unccdfy{(1-\un)}{x}\right)^{\Nt-1} \ytimespdfyNr dx\\ + \frac{\Nt\m}{\Gamma(Nr)}\left(\albysnr\right)^{Nr} \int_{0}^{1-\lambym} \left(\unccdfy{(1-\un)}{\left(x+\lambym\right)} + \unccdfy{\un}{x}\right)^{\Nt-1}\\ \times\left((1-\un)\ypluslamtimespdfyNr+\un\ytimespdfyNr\right) dx\\ +m\left(\unccdfy{\un}{\left(1-\lambym\right)}\right)^{\Nt}.                                     \end{multline}


\subsection{Rayleigh Fading}
We now consider Rayleigh fading. Here, $\hij$ and $\gk{j}$ are i.i.d.\ exponential RVs. Let $\muh$ and $\mug$ denote the means of $\hij$ and $\gk{j}$, respectively. It can be shown that the interference-outage probability $\un$ is equal to $\inlccdfg[]$. This means that the optimal TAS rule will be same as the interference unconstrained rule for $\Pt\leq {\tau}/{\left(\mug\ln\left(1/\outmax\right)\right)}$ or, equivalently, for $\itau\geq\Pt\mug\ln\left(1/\outmax\right)$.  Let $\snr\define\Pt\muh/\noisevar$ denote the mean signal-to-noise-ratio of the SU.
\subsubsection{$\Nr$ Receive Antennas at the SRx} From~\eqref{eq:yi_def}, $\yk{1}$ is an exponential function of a gamma RV with $\Nr$ degrees of freedom. Thus, the CCDF and PDF of the RV $\yk{1}$ are given by 
\begin{align}
\label{eq:ccdfyNr}
\ccdfy{x} &= \ccdfyNr{x}, \quad \text{for} \quad x \in (0,1],\\
\label{eq:pdfyNr}
\pdfyNrgen{x} &= \pdfyNr, \quad \text{for} \quad x \in (0,1],
\end{align}
where $\gamma(\cdot,\cdot)$ denote the lower incomplete gamma function~\cite[(8.350.1)]{gradshteyn00_book}. Then, the average SEP of an SU with $\Nr$ antennas at the SRx can be obtained by substituting these in~\eqref{eq:termone_gen} and \eqref{eq:termtwo_gen}, Note that further simplification is not possible due to the lower incomplete gamma function inside the integral. Also note that substituting these in~\eqref{eq:pr_outage_ccdf} yields the interference-outage probability expression for Rayleigh fading.
%
\subsubsection{Single Receive Antenna at the SRx ($\Nr=1$)} 
Here, $\yk{1}$ is an exponential function of an exponential RV.  By substituting $\Nr=1$ in~\eqref{eq:ccdfyNr} and~\eqref{eq:pdfyNr}, we get $F_{y}^{c}(x) = 1-x^{\albysnr}$, for $x \in (0,1]$ and $f_{y}(x) = \al x^{\albysnr-1}/\snr$, for $x \in (0,1]$. Substituting these in~\eqref{eq:termone_gen} and \eqref{eq:termtwo_gen}  simplifies $\avgSEP$ for $\Nr=1$ and Rayleigh fading as below:
%
\begin{multline}
\label{eq:avgSEPoneNr} 
\avgSEP =\zerosep\un^{\Nt}\left[1-\left(1-\lamstarbym\right)^{\albysnr[]}\right]^{\Nt}
 + +\!\frac{\Nt\un^{\Nt}\al\lamstar}{\snr}\!\! \sum_{k=0}^{\Nt-1}\!\sum_{n=0}^{k} \!\! \frac{\nck{\Nt-1}{k} \!\nck{k}{n}\!(-1)^{n}\!\!\left(\!\lamstarbym\!\right)^{\!\!\!\!\albysnr[(n+1)]\!\!}\!\!\!\!\left(\!\frac{1}{\un}\!-\!1\!\right)^{\!k+1} \!}{\albysnr[(n+1)]+1}\\ + \!\frac{\Nt\m\al}{\snr}\! \sum_{k=0}^{\Nt-1}\! \sum_{i=0}^{k}\! \sum_{j=0}^{\Nt-k-1}\!\! \binom{\Nt-1}{k} \!\binom{k}{i}\! \binom{\Nt-k-1}{j} \!(-1)^{\!i+j} \un^{k} (1\!-\!\un)^{\Nt-k-1} \left( \un \,\,\psifun{j}{i+1} \!+ \! \left(1\!-\!\un\right) \psifun{j+1}{i} \right) 
,
\end{multline}
where $\psifun{k_1}{k_2} = \int_{0}^{1-\frac{\lamstar}{\m}} \left(x+\lamstarbym\right)^{\albysnr[k_1]} x^{\albysnr[k_2]} \,dx$.
%
In general $\psifun{k_1}{k_2}$ can be computed accurately as a sum of $n$  terms as follows: 
\begin{equation}
\psifun{k_1}{k_2} ={\onemlc^{\!\!\albysnr[k_2]+1}} \sum_{i=1}^{n} w_{i} {\left(\!x_i\!\onemlc \!+\!\lamstarbym\!\right)}^{\!\!\!\albysnr[k_1]}\!\!\! \!x_i^{\albysnr[k_2]} \!\!+ \text{o}\!\left(\!\frac{1}{n^2}\!\right),
\label{eq:gauss_quad}
\end{equation}
where $x_i$ and $w_i$ are the $n$ Gauss quadrature abscissas and weights~\cite{abramowitz_stegun}, respectively. In Section~\ref{sec:results}, we will see that this approximation is accurate even for $n$ as small as four. Furthermore, for $\lam\in({\m}/{2}, \m]$, the integral can be written  in terms of a series as  follows~\cite{gradshteyn00_book}:
%
\begin{multline}
\psifun{k_1}{k_2} = \frac{\left(\lambym\right)^{\albysnr[k_1]} \left(1-\lambym\right)^{\albysnr[k_2]+1}}{\albysnr[k_2]+1} \\
+ \sum_{\lidx=1}^{\infty}\! \frac{\akone\!\!\left(\akone\!-\!1\right)\!\ldots\!\left(\akone\!-\!\lidx\!+\!1\right)\!\left(\!\lambym\!\right)^{\!\!\albysnr[k_1]  - \lidx} \!\!\left(\!1\!-\!\lambym\!\right)^{\!\!\albysnr[k_2]+\lidx+1}}{\lidx ! \left(\albysnr[k_2]+\lidx+1\right)}. 
\label{eq:inf_sum}
\end{multline}

%
%Using Gauss quadrature~\cite{abramowitz_stegun}, 
%

%\subsection{Simpler TAS Rule and interference-outage Expressions}
\subsection{Insights: Simpler TAS Rule and Interference-Outage Expressions}
In this section, we gain several insights on the behavior of the optimal TAS rule. We will first show that it simplifies in the high transmit power regime and also has a simple form for its interference-outage probability. Another insightful case is when the STx is equipped with two transmit antennas, for which we derive a different upper bound for interference-outage probability.  
%
\subsubsection{High Transmit Power Regime}
\label{sec:high_power}
For large values of $\Pt$, interference power seen at the PRx is very high. This forces the value of the interference-outage penalty factor $\lam$ close to $\cone$ in order to penalize the antenna to the highest for transmitting and to ensure that the interference-outage constraint is met. Let $\goodset$ denote the set of all outage-compatible antennas for a given channel realization. Two possibilities exist for $\goodset$: 

\begin{itemize}
	\item {\em $\goodset$ is Not Empty:} In this case, as $\lam/\m$ tends to one, the metric $\ykplambym{j}$ of every outage-incompatible antenna $j$ is greater than the metric $\yk{k}$ of any outage-compatible antenna $k$ because $\yk{k}\leq 1$. Hence, the optimal TAS rule will only select an outage-compatible antenna, and  reduces to $s=\argmin_{k\in\goodset} \left\{ \yk{k} \right\} = \argmax_{k\in\goodset} \left\{ \sumnr \hk{ik} \right\}$. Here, the second equality follows from~\eqref{eq:yi_def} . Hence, the optimal TAS rule selects an antenna with the highest $\sumnr \hk{ik}$ from the antennas in $\goodset$. 
	
	\item {\em $\goodset$ is Empty:} In this case, all the antennas are outage-incompatible. Hence, the optimal TAS rule reduces to $s= \argmin\left\{\yk{0},\ykplambym{1},\ldots,\ykplambym{\Nt}\right\}$, where as mentioned, $\yk{0}=1$. Using $\yk{0}=1$ and~\eqref{eq:yi_def} we can show that $s=\arg\max\{\igamma,\sumnr \hk{i1},\dots,\sumnr\hk{i\Nt}\}$. Hence the optimal TAS rule will transmit with a non-zero antenna if and only if there is at least one antenna $k$ for which $\sumnr \hk{ik}$ exceeds the threshold  $\igammainline$. Else, it selects $s=0$.
\end{itemize}

Combining the above two cases, the optimal TAS rule in the high transmit power regime simplifies to
\begin{equation}
\label{eq:hp_rule}
\callamrule: s = \left\{
 \begin{array}{ll}
\argmax\limits_{k\in\goodset}\{\sumnr \hk{ik}\}, & \text{if}~\goodset\neq\nullset, \\
\argmax\{\igamma,\sumnr\hk{i1},\dots,\sumnr\hk{i\Nt}\}, &\text{otherwise}.
\end{array}\right.
\end{equation}

We now analyze the interference-outage probability of the TAS rule in~\eqref{eq:hp_rule}. Here, an interference-outage happens only when $\goodset$ is empty and the STx  transmits with $s\neq\nx$. Hence,  $\outlam=\prob{{\goodset}=\nullset, s \neq 0}$. This can be shown to be equal to be equal to
\begin{equation}
\label{eq:pr_outage_hp}
 \outlam = \un^{\Nt} - \un^{\Nt}\left( \frac{\gamma\left(Nr,-\albysnr[]\ln\left(1-\lambym\right)\right)}{\Gamma\left(Nr\right)}\right)^{\Nt}.
 %\outlam  =  \un^{\Nt} - \un^{\Nt}\left[1 - \left(1-\lambym\right)^{\albysnr[]} \right]^{\Nt}.
\end{equation}
For $\Nr=1$ equating this $\outlam$ with $\outmax$ and solving yields the following closed-form expression for $\lam$. 
\begin{equation}
\label{eq:lam_asym}
 \lam  =  \m - \m\left(1 - \left(1 - \frac{\outmax}{\un^{\Nt}}\right)^{\frac{1}{\Nt}} \right)^{\snrbyal[]}.
\end{equation}
%
This expression applies only when $\un^{\Nt}$ is greater than $\outmax$, which is equivalent to $\itau\leq\left(\Pt\mug/\Nt\right)\ln\left(1/\outmax\right)$.  

\subsubsection{Two Transmit Antennas at STx} 
An even simpler upper bound for the interference-outage probability can be obtained when $\Nt=2$. For this, we replace $1-\left(\lam/\m\right)$, in the second term of~\eqref{eq:pr_outage_ub}, with one. For Rayleigh fading this yields the following simpler upper bound:
%
\begin{equation}
\outlam \leq  2\un - \un^2-2\un(1-\un)\left(\lambym\right)^{\albysnr[]}.
\label{eq:out_bound_two_amt}
\end{equation}
%
Equating~\eqref{eq:out_bound_two_amt}  with $\outmax$ yields the following upper bound for $\lam$:
\begin{equation}
\label{eq:two_Nt_lam}
\lam \leq \cone \left( \frac{2\un - \un^2 - \outmax}{2\un(1-\un)} \right)^{\snrbyal[]}.
\end{equation} 
Note that the above upper bound will be less than or equal to $\cone$ only when $\frac{2\un - \un^2 - \outmax}{2\un(1-\un)}\leq 1$, which simplifies to $\un^2 \leq \outmax$, which is equivalent to $\itau\geq\left({\Pt\mug}/{2}\right)\ln\left(1/\outmax\right)$.
%which means for $\Pt<\frac{2\tau}{\mug\ln\left(1/\outmax\right)}$. 



\section{Impact of Imperfect CSI}
\label{sec:imperfectcsi}
The optimal TAS rule in~\eqref{eq:lam_weight_rule} requires the perfect knowledge of channel power gains $\Hmx$ and $\g$. In this section, we study how the optimal TAS rule performs when STx only has imperfect channel power gain estimates of STx-SRx and STx-PRx links. We assume that the SRx knows $\Nr$  complex channel gains corresponding to the antenna selected perfectly. We derive the analytical expressions for the interference-outage probability at the PRx and the average SEP of the SU with imperfect CSI. 


{\em Channel Estimation Model}: Let $\sugain{ik} = \sqrt{\hk{ik}}e^{-j\suchph_{ik}}\sim\CN\left(0,\muh\right) $ denote the complex baseband channel gain of the link from $\kth$ transmit antenna of the STx to the $\ith$ receive antenna of the SRx and $\pugain{k} = \sqrt{\gk{k}}e^{-j\puchph_{k}}\sim\CN\left(0,\mug\right)$ denote the complex baseband channel gain from the $\kth$ antenna of the STx to the PRx.  Let $\hpilotrcv$ and $\gpilotrcv$ denote the signals received at the STx when pilot symbols $\hpilotsym$ and $\gpilotsym$ are transmitted by the SRx and PRx, respectively. Then, $\hpilotrcv$ and $\gpilotrcv$ are given by  
\begin{align}
\label{eq:yhat_su}
\hpilotrcv & = \sqrt{\hpilotpower} \sugain{ik} \hpilotsym  + \hpilotnoise, \\
\label{eq:yhat_pu}
\gpilotrcv & = \sqrt{\gpilotpower} \pugain{k} \gpilotsym  + \gpilotnoise, 
\end{align}
where $\hpilotpower$ and $\gpilotpower$ are the transmit pilot powers used by the SRx and PRx, respectively, $|\hpilotsym|^2=1$, $|\gpilotsym|^2=1$, $\hpilotnoise \sim\CN\left(0,1\right) $ and $\gpilotnoise\sim \CN\left(0,1 \right) $. 

Using the received signals $\hpilotrcv$ and $\gpilotrcv$  at the STx, the minimum mean square error (MMSE) estimates of $\sugain{ik}$ and $\pugain{k}$ which we denote by $\sugainhat{ik}$ and $\pugainhat{k}$ are given by 
%
\begin{align}
\label{eq:alpha_hat}
\sugainhat{ik} &= \frac{\sqrt{\hpilotpower}\muh}{\hpilotpower\muh + 1}  \hpilotsym^{*} \hpilotrcv,\\
\label{eq:beta_hat} 
\pugainhat{k} &= \frac{\sqrt{\gpilotpower}\mug}{\gpilotpower\mug + 1}  \gpilotsym^{*} \gpilotrcv.
\end{align}
%
This MMSE channel estimate is also used for modeling imperfect CSI in~\cite{XKang_2011_JSAC,Kashyap_2014_TCOM,Rezki_2012_ieeeVt}. Let $\muhhat$ and $\mughat$ denote the variance of $\sugainhat{ik}$ and $\pugainhat{k}$ respectively. 
Then, from~\eqref{eq:alpha_hat} and~\eqref{eq:beta_hat} we know that $\sugainhat{ik}\sim\CN\left(0, \muhhat \right)$ and $\pugainhat{k}\sim \CN\left(0, \mughat\right) $, where  $\muhhat ={\hpilotpower\muh^2}/{\left( \hpilotpower\muh+1\right)}$ and $\mughat = {\gpilotpower\mug^2}/{\left( \gpilotpower\mug+1\right)}$. This means the channel power gain estimates $\hkhat{ik}=|\sugainhat{ik}|^2$ and $\gkhat{k}=|\pugainhat{k}|^2$ are exponential RVs with means $\muhhat$ and $\mughat$, respectively. We denote the correlation coefficient of $\hk{ik}$ and $\hkhat{ik}$ by $\rhoh\define{\hpilotpower\muh}/{\left( \hpilotpower\muh + 1\right) }$ and the correlation coefficient of $\gk{k}$ and $\gkhat{k}$ by $\rhog \define{\gpilotpower\mug}/{\left( \gpilotpower\mug + 1\right) }$. Let  $\unhat\define\ccdfghatinline$ denote the CCDF of the i.i.d. RVs $\gkhat{1},\ldots,\gkhat{\Nt}$ and $\snrhat\define{\Pt\muhhat}/{\noisevar}$.
Now we define 
\begin{equation}
\ykhat{k} \define  \exp\left({- \frac{\Pt\sum_{i=1}^{\Nr}\hkhat{ik}}{\ctwo\noisevar} }\right), \quad \text{for} \quad 0\leq k \leq\Nt,
\label{eq:yihat_def}
\end{equation}
$\yhatvec\define\left[\ykhat{1},\ldots,\ykhat{\Nt} \right]$, and $\ghatvec\define\left[\gkhat{1},\ldots,\gkhat{\Nt} \right]$.
Thus, when STx only knows $\yhatvec$ and $\ghatvec$  the antenna $\shat$ selected by optimal TAS rule $\callamstarrule$ can be written as 
\begin{equation}
\shat=\argmin\limits_{k\in\allopts} \left\{ \ykhatplusgkhat{k} \right\},
\label{eq:shat}
\end{equation}
where $\lamstar$ is obtained by equating interference-outage probability $\outlam$ in~\eqref{eq:pr_outage_ccdf} to $\outmax$. 

\newcommand{\pdfyhatNr}{\left(\ln\left(\frac{1}{x}\right)\right)^{\Nr-1}x^{\albysnr[]-1}} % only y terms constants taken care separately
\newcommand{\yhattimespdfyNr}{\left[\ln\left(\frac{1}{x}\right)\right]^{\Nr-1}x^{D}} % only y terms constants taken care separately
\newcommand{\yhatpluslamstartimespdfyNr}{\left[\ln\left(\frac{1}{x+\lamstarbym}\right)\right]^{\Nr-1}\left(x+\lamstarbym\right)^{D}} % only y terms constants taken care separately
\newcommand{\unccdfyhat}[2]{\frac{{#1}\,\,\gamma\left(\Nr,-\albysnrhat\ln{#2}\right)}{\Gamma\left(Nr\right)}}


\newcommand{\avgSEPhat}{\widehat{\SEP}}

{\em Average SEP:} We now derive the average SEP expression of the optimal TAS rule for an  STx with imperfect CSI. We denote this by $\avgSEPhat$. 

\begin{theorem}
\label{thm:avg_SEP_imperfect}
The $\avgSEPhat$ of the $\callamstarrule$ for an  $\Nt$x$\Nr$ SU with imperfect CSI at STx is given by
\begin{multline}
\label{eq:avg_SEP_imperfect}
\avgSEPhat = \frac{\Nt \T^{\Nr}\m(1-\unhat)}{\Gamma(Nr)}\int_{0}^{\lamstarbym} \left[\unhat + \unccdfyhat{(1-\unhat)}{x}\right]^{\Nt-1} \yhattimespdfyNr dx\\
+ \frac{\Nt \T^{\Nr}\m}{\Gamma(Nr)} \int_{0}^{1-\lamstarbym}
\left[\unccdfyhat{(1-\unhat)}{\left(x+\lamstarbym\right)} + \unccdfyhat{\unhat}{x}\right]^{\Nt-1}\\
\times\left((1-\unhat)\yhatpluslamstartimespdfyNr+\unhat\yhattimespdfyNr\right)\, dx\\
+m\left[\unccdfyhat{\unhat}{\left(1-\lamstarbym\right)}\right]^{\Nt},
\end{multline}
where $\T \define \Tc$ and $D \define \Dc$.	
\end{theorem}
\begin{IEEEproof}
	The proof is given in Appendix~\ref{proof:avg_SEP_imperfect_CSI}.
\end{IEEEproof}
Note that substituting $\snrhat=\snr$, $\rhoh=1$, and $\unhat=\un$ in~\eqref{eq:avg_SEP_imperfect} reduces it to the average SEP expression for perfect CSI case.



{\em Interference-outage probability:} For $\outmax \geq \outlam$ the optimal TAS rule is equivalent to the interference unconstrained rule $\caluncons$ and the antenna selected does not depend on the  STx-PRx channel power gains. Thus, the interference-outage probability $\prob{\gkgrtaubypt{s}}$ will remain same as the perfect CSI case. We now derive the interference-outage probability with imperfect CSI at the STx when $\outmax < \outlam$.

\begin{theorem}
\label{thm:outage_imperfect_CSI}
The interference-outage probability $\outhatlamstar$ at the PRx with imperfect CSI at the STx is given by
\begin{multline}
\label{eq:pr_outage_impefect} 
\!\outhatlamstar \!=\! \Nt \!\int_{0}^{1-\lambym} 	
\!\left[\left(1 -\unhat\right)F_{\yhat}^{c}\left(x+\lamstarbym\right) + \unhat F_{\yhat}^{c}\left(x\right)\right]^{\Nt-1}\!\! \left(\! \Probglt f_{\yhat}\!\left(\! x+\lamstarbym\right) \!+\! (\un - \Probglt) f_{\yhat}\left(x\right)\!\right) dx\\
+ \frac{ \Probglt}{1 - \unhat} \left( 1 - \left[ \left(1 -\unhat\right)F_{\yhat}^{c}\left(\lamstarbym\right) + \unhat \right]^{\Nt}  \right) ,
\end{multline}
%
where $\Probglt = \un Q_1\left(\frac{\rhog}{ \gpilotpower} \sqrt{\frac{2\itau}{ \gpilotpower\Pt}},\sqrt{\frac{2 \gpilotpower\itau}{\Pt}}\right)  - \frac{\unhat}{2} \left( 1 + e^{-\frac{2\itau\rhog}{ \gpilotpower\Pt}}I_{0}\left(\frac{2\itau\rhog}{ \gpilotpower\Pt} \right) \right)$, $I_{0}(\cdot)$ is the modified Bessel function of the zeroth order,  $Q_1(\cdot,\cdot)$ is the Marcum-Q function~\cite[(4.34)]{simon_alouini_book}, $F_{\yhat}^{c}\left(x\right) = \frac{\gamma\left(Nr,-\albysnrhat[]\ln(x)\right)}{\Gamma(\Nr)}$, and $f_{\yhat}\left( x\right) = \frac{ \left( \albysnrhat \right)^{\Nr} \left(\ln\left(\frac{1}{x} \right)\right)^{\Nr-1} x^{\albysnrhat - 1}}{\Gamma(\Nr)}$.
\end{theorem}
%
\begin{IEEEproof}
	The proof is given in Appendix~\ref{proof:outage_imperfect_CSI}.
\end{IEEEproof}
%
Note that in the interference unconstrained case, the interference-outage probability in~\eqref{eq:pr_outage_impefect} reduces to $\un$. Furthermore, when $\lamstar=\cone$ it simplifies to a non-zero value $\frac{ \Probglt \left( 1-\unhat^{\Nt}\right) }{1-\unhat}$ unlike the perfect CSI case. Substituting $\Probglt=0$ in~\eqref{eq:pr_outage_impefect} reduces $\outhatlamstar$ to the same form as $\outlam$ in~\eqref{eq:pr_outage_ccdf}.
We can also obtain a closed-form upper bound for $\outhatlamstar$ similar to the~\eqref{eq:pr_outage_ub} as below: 
\begin{multline}
\label{eq:pr_outage_imperfect_ub}
\outhatlamstar  \leq \left(\frac{\un - \Probglt}{\unhat}\right)\left( \left[\unhat + \left(1-\unhat\right)F_{y}^{c}\left(\lamstarbym\right)\right]^{\Nt} - \left[ \unhat F_{y}^{c}\left(1-\lamstarbym\right) + \left(1-\unhat\right)F_{y}^{c}\left(\lamstarbym\right)  \right]^{\Nt}\right) \\
+  \frac{ \Probglt \left( 1-\unhat^{\Nt}\right) }{1-\unhat}  .
\end{multline}




\section{Numerical Results and Performance Benchmarking}
\label{sec:results}
We now present Monte Carlo simulations that use $10^6$ data symbols to verify our analytical results developed for Rayleigh fading and study the behavior of the optimal TAS rule as a function of different system parameters. We also benchmark the performance of the optimal TAS rule against other TAS rules in the literature. We set $\noisevar =1$ and $\muh =\mug = 1$ in the simulations. 

Figure~\ref{fig:SEP_vs_PT} plots the average SEP of the optimal TAS rule as a function of the transmit power $\Pt$ for $\itau=8$~dB and $\Nr=2$. This is done for two values of $\outmax$ and two values of $\Nt$. We observe that the analysis expression in~\eqref{eq:SEP_MPSK_Nt_gen} matches well with the simulations for $\Nr=2$. To understand its behavior, the transmit power needs to be divided into three regions. Consider for example, $\outmax=0.1$ and $\Nt=4$. Then (i) $\Pt \leq 4.4$~dB: Here, the STx is in {\em interference-outage unconstrained} region. Hence, the optimal TAS rule is same as the interference unconstrained rule $\caluncons$. In general, this boundary value of $\Pt$ is given by ${\tau}/{\left(\mug\ln\left(1/\outmax\right)\right)}$; it is independent of $\Nt$. (ii) $4.4~\text{dB} <\Pt \leq 9~\text{dB}$: Here, the STx is in {\em interference-outage constrained} region but, $\lamstar$ is very close to zero. Thus, the SEP still decreases as $\Pt$ increases. (iii) $\Pt > 9$~dB: Here, $\lamstar>0.02$. This increases the probability of the event that the STx selects antenna zero. As $\lamstar$ increases, this probability increases. Its SEP, which is $1- \frac{1}{M}$ dominates the average SEP. Thus, in this region it increases with $\Pt$. In practice this increase can be avoided by using a lower transmit power of $\Pt=9$~dB for $\outmax=0.1$ and $\Nt=4$, and $\Pt=6.7$ for $\outmax=0.1$ and $\Nt=2$.  Notice that average SEP decreases as $\outmax$ increase, as the interference-outage constraint is weekend. It also decreases significantly as $\Nt$ increases due to increased spatial diversity.      

\begin{figure}
  \centering \includegraphics[width=\linewidth]{plots/PCSI_gs_SEP_vs_Pt_pout_5_10_tau_8dB_Nt_4_2_Nr_2_M_4.eps}
  \caption{SEP of the optimal TAS rule as a function of $\Pt$ for different values of $\outmax$ and transmit antennas ($\itau = 8$~dB, $\Nr=2$, and QPSK). Simulation results are shown using x and analytical results using lines.}
\label{fig:SEP_vs_PT}
\end{figure}


Figure~\ref{fig:SEP_vs_tau_QAM} plots the average SEP as a function of interference power threshold $\tau$ for $\Pt = 13$~dB, $\Nt=8$ and $\Nr=1$. This is done for 8-PSK and 16-QAM, and for two values of $\outmax$. The simplified average SEP formula for $\Nr=1$ in~\eqref{eq:avgSEPoneNr} and its approximation in~\eqref{eq:gauss_quad} (with $n = 4$ for 16-QAM and $n=8$ for 8-PSK)  are shown. We observe a good match between them and simulations, which simulate the entire transmit and receive chains and do not assume the formula in~\eqref{eq:isep}. To explain the average SEP behavior we consider $\outmax=0.2$ curve in two regions; (i) Interference-outage constrained ($\itau < 15$~dB): Here, $\lamstar>0$ and the average SEP decreases as $\itau$ increases because the interference power allowed at PRx is increasing, (ii) Interference-outage unconstrained ($\itau \geq 15$~dB): Here,  $\lamstar=0$ and the average SEP saturates to a fixed value, which is independent of $\outmax$. This happens because the optimal TAS rule becomes same as the interference unconstrained rule $\caluncons$ for $\itau\geq \Pt\mug\ln\left(1/\outmax \right)$. This boundary value is independent of the  constellations size and is equal to $16.6$~dB when $\outmax=0.1$. 

\begin{figure}
	\centering \includegraphics[width=\linewidth]{plots/CURVE_FIT_SEP_vs_tau_pout_20_PT_13dB_Nt_8_M_8_16.eps}
	\caption{SEP as a function of $\itau$ for 8-PSK and 16-QAM for different values of $\outmax$ ($\Pt = 13$~dB, $\Nt=8$, and $\Nr=1$).}
	\label{fig:SEP_vs_tau_QAM}
\end{figure}



Figure~\ref{fig:outage_vs_lambym} plots the interference-outage probability as a function of $\lam/\cone$,  for $\Nt = 2$, $\Nr=1$, $\Pt = 8$~dB, and $\itau = 10$~dB.  We see that the exact interference-outage expression in~\eqref{eq:pr_outage_ccdf} matches well with the simulations. Also plotted are the interference-outage upper bound expressions in~\eqref{eq:pr_outage_ub} and~\eqref{eq:out_bound_two_amt} and the asymptotic expression in~\eqref{eq:pr_outage_hp}. We observe that the gap between exact value and the upper bound in~\eqref{eq:pr_outage_ub} decreases to zero as $\lam$ increases. Furthermore, the asymptotic expression in~\eqref{eq:pr_outage_hp} also matches with the exact interference-outage as $\lam$  tends to $\cone$.

\begin{figure}
  \centering \includegraphics[width=\linewidth]{plots/outage_vs_lambym_tau_10dB_PT_8dB_Nt_2_M_4.eps}
  \caption{Interference-outage probability as a function of $\lam/\m$ ($\Nt = 2$, $\Nr=1$, $\Pt = 8$~dB, and $\itau = 10$~dB).}
\label{fig:outage_vs_lambym}
\end{figure}





{\em Performance Benchmarking:} We now compare the performance of the optimal TAS rule with the enhanced minimum interference (EMI) rule~\cite{Sarvendranath_2013_TCOM}, the difference selection (DS) rule~\cite{Wang_2011_TCom},  and enhanced maximum-signal-power to leak-interference-power-ratio (EMSLIR) rules~\cite{Sarvendranath_2013_TCOM}.  The EMI rule selects the antenna with the lowest STx-PRx channel power gain. However, it selects antenna zero when all the STx-PRx channel power gains are above a threshold, which is chosen to meet interference constraint. It causes the least interference to the PRx and is the best rule from the point of view of the primary. The EMSLIR rule selects the antenna with the largest ratio of the STx-SRx channel power gain to the STx-PRx channel power gain. However, it selects antenna zero when the ratios of the channel power gains of all the antennas are below a threshold, which is chosen to meet the interference constraint with equality. It is a relevant benchmark as it maximizes the SU capacity under the peak interference power constraint~\cite{Wang_2010_TWC}. The DS rule chooses the antenna that maximizes the difference $\delta \hk{i} -(1-\delta) \gk{i} $, where $\delta$ is chosen to meet the interference constraint with equality.   

Figure~\ref{fig:BM_SEP_vs_tau} compares the average SEP of the optimal TAS rule with that of the EMI, DS, and EMSLIR rules, for $\Nt = 4$, $\Pt = 12$~dB, and $\outmax = 0.2$. (i)~For $\itau < 14$~dB, the optimal TAS rule is in interference-outage constrained region . Here, $\lamstar>0$ and the optimal TAS rule outperforms all the benchmark rules, with the performance gap increasing as $\itau$ increases. For example, at $\itau=11$~dB,  its average SEP is lower by a factor of $70$, $13$, and $11$ than the EMI, DS, and EMSLIR rules. (ii)~For $\itau \geq 14$~dB, the average SEP saturates for both the optimal TAS rule and the DS rule. This is because the interference-outage constraint becomes inactive and they become equivalent to the interference unconstrained rule $\caluncons$ in~\eqref{eq:uncons_simple}. We also observe that the average SEPs of EMI and EMSLIR rules saturate for $\itau$ greater than $8.5$~dB and $11$~dB, respectively. We also plot the average SEP of the optimal TAS rule using the value of $\lamstar$ that is obtained by equating the integral-free interference-outage probability upper bound in~\eqref{eq:pr_outage_ub} to $\outmax$. We see that the degradation in the average SEP  is negligible when compared to using the exact $\lamstar$. 

\begin{figure}
	\centering \includegraphics[width=\linewidth]{plots/BM_gs_SEP_vs_tau_pout_20_PT_12dB_Nt_4_M_4.eps}
	\caption{SEP comparison of the optimal TAS rule and benchmark rules ($\Nt = 4$, $\Nr=1$, $\Pt = 12$~dB, $\outmax = 0.2$, and QPSK).}
	\label{fig:BM_SEP_vs_tau}
\end{figure}


Figure~\ref{fig:out_vs_tau_imp_CSI} plots the interference-outage probability as a function of $\itau$ for different values of pilot powers of SRx and PRx for $\Nt=2$, $\Nr=2$, $\outmax = 0.1$, and $\Pt=10$~dB. We see that the simulation results are in agreement with the analysis. In order to understand the behavior of the interference-outage probability in the interference-outage constrained region ($\tau\leq 13.6$~dB), we consider the below four cases. (i) Perfect CSI ($\hpilotpower=\infty$~dB and $\gpilotpower=\infty$~dB): Interference-outage caused to the PRx meets $\outmax=0.1$ exactly. (ii) Imperfect $\Hmx$ and perfect $\g$ ($\hpilotpower=5$~dB and $\gpilotpower=\infty$~dB): Here, the interference-outage at the PRx is less than $\outmax$ for $\itau\leq 10.6$~dB and is greater than $\outmax$ for $10.6~\text{dB}<\itau<13.6$~dB. (iii) Perfect $\Hmx$ and imperfect $\g$ ($\hpilotpower=\infty$~dB and $\gpilotpower=5$~dB): Here, the interference-outage at the PRx is greater than $\outmax$ as the STx-PRx channel information is not perfect. (iv) Imperfect CSI ($\hpilotpower=5$~dB and $\gpilotpower=5$~dB): Here also the interference-outage at the PRx is greater than $\outmax$. However, the increase in the violation compared the case iii with perfect $\h$ is very small as the interference-outage probability mainly depends on the STx-PRx channel power gain. In the interference unconstrained region ($\itau>13.6$~dB) the optimal TAS rule becomes same as $\caluncons$. Hence, the interference-outage probability becomes $\un$ and decreases with increase in $\itau$ for all the four cases above.

\begin{figure}
	\centering \includegraphics[width=\linewidth]{plots/Combined_outage_vs_tau_pout_10_PT_10dB_Nt_2_Nr_2_M_4.eps}
	\caption{Interference-outage probability as a function of $\itau$ ($\outmax=0.1$, $\Pt = 10$~dB, $\Nt = 2$, $\Nr = 2$, and QPSK). Simulation results are shown using marker x and analytical results using lines.}
	\label{fig:out_vs_tau_imp_CSI}
\end{figure}


Figure~\ref{fig:sep_vs_tau_imp_CSI} plots the average SEP as a function of $\itau$ for 
different values of pilot powers of SRx and PRx for $\Nt=2$, $\Nr=2$, $\outmax = 0.1$, and $\Pt=10$~dB. The simulation results and analysis match very well. In order to study the impact of imperfect CSI on the average SEP, we compare the following cases with perfect CSI curve shown in solid line.  (i) Perfect $\Hmx$ and imperfect $\g$ ($\hpilotpower=\infty$~dB and $\gpilotpower=5$~dB): In the interference constrained region ($\itau\leq 13.6$~dB) we see an improvement in the average SEP. This is because the STx causes interference-outage greater than $\outmax$ as seen in Figure~\ref{fig:out_vs_tau_imp_CSI}. Further, in the interference unconstrained region ($\itau> 13.6$~dB) the average SEP matches with the perfect CSI case as the optimal TAS rule does not depend on $\g$. (ii) Imperfect $\Hmx$ and perfect $\g$ ($\hpilotpower=5$~dB and $\gpilotpower=\infty$~dB): In this case, the average SEP degrades compared to the perfect CSI case. Though it follows the same trend as the perfect CSI case, it saturates to a higher value. This is result of the imperfect $\Hmx$ and causing interference-outage lower than  $\outmax$ at the PRx (iii) Imperfect CSI ($\hpilotpower=5$~dB and $\gpilotpower=5$~dB): In this case for $\itau\leq 10$~dB the average SEP is slightly lower than the perfect CSI case reflecting the behavior in case 1 (imperfect $g$) and for $\itau>10$~dB the average SEP matches with the curve in the case 2 (Imperfect $\h$). Finally, from case ii and case iii, it is clear that the average SEP for large values of $\itau$ depends only on the accuracy of the STx-SRx channel power gain.

\begin{figure}
	\centering \includegraphics[width=\linewidth]{plots/Combined_SEP_vs_tau_pout_10_PT_10dB_Nt_2_Nr_2_M_4.eps}
	\caption{Average SEP as a function of $\itau$ ($\Nt=2$, $\Nr=2$, $\Pt=10$~dB, $\outmax = 0.1$ and QPSK). Simulation results are shown using marker x and analytical results using lines.}
	\label{fig:sep_vs_tau_imp_CSI}
\end{figure}




\section{Conclusions}
\label{sec:conclusions}


\appendix
\subsection{Proof of Lemma~\ref{lem:outage_Nt}}
\label{proof:outage_Nt}
We first derive the interference-outage expression in~\eqref{eq:pr_outage_ccdf}. 
Using the law of total probability, the interference-outage probability $\outlam=\prob{\gkgrtaubypt{s}}$ can be obtained by summing over all the antennas selected as follows:
%
\begin{equation}
\outlam= \sum_{i=0}^{\Nt}\prob{s=i,\gk{i}>\taubypt}.
\label{eq:out_1}
\end{equation}
%
When $i=0$, we have $\gk{0}=0$. Therefore, $\prob{s=0,\gk{0}>\taubypt}=0$.  
%
Since the antennas are statistically identical, using symmetry, we can write
%
\begin{equation}
\outlam=\Nt\text{Pr}\brac{s=1,\gk{1}>\taubypt}.
\label{eq:out_2}
\end{equation}
%

Let $k$ antennas out of the antennas $2,\ldots,\Nt$ be outage-compatible. The total number of ways in which such $k$ antennas can be chosen from $\Nt-1$ antennas is $\nck{\Nt-1}{k}$. One such combination is denoted by the set $\setB=\left\{\gklttaubypt{2},\dots,\gklttaubypt{k+1},\gkgrtaubypt{k+2},\dots,\gkgrtaubypt{\Nt}\right\}$. $\setAgt\define\left\{\left(\gkgrtaubypt{1}\right)\cap\setB \right\}$. Given $k$, all these combinations are equally likely because the antennas are statistically identical. Therefore, using the law of total probability, we can write $\outlam$ as a summation over all the values of $k$ as
%
\begin{equation}
\outlam =\Nt\sum_{k=0}^{\Nt-1}\nck{\Nt-1}{k} \text{Pr}\brac{\setAgt} \text{Pr}\brac{s = 1\Given \setAgt}. 
\label{eq:out_3}
\end{equation}
%
Since $\gk{1},\ldots,\gk{\Nt}$ are i.i.d., we get $\prob{\setAgt} = \left(1-\un\right)^k\un^{\Nt-k}$.
%

{\em Expression for $\prob{s = 1\Given\setAgt}$:} Given $\setAgt$, $\callamrule$ selects antenna one if $\ykplambym{1}<\yk{i}$, for $2\leq i \leq k+1$,  $\ykplambym{1}<\ykplambym{j}$, for $k+2\leq j \leq \Nt$, and $\ykplambym{1}<\yk{0}=1$. Hence,
%
\begin{align}
\label{eq:out_5}
\prob{s = 1\Given \setAgt }&=\text{Pr}\left(\ykplambym{1} < 1, \ykplambym{1}<\yk{2}, \dots ,\ykplambym{1}<\yk{k+1},\right.\nonumber\\
&\quad\quad\quad\left.
\ykplambym{1}<\ykplambym{k+2}, \dots ,\ykplambym{1}<\ykplambym{\Nt}\right),  \\
&=\explow{\yk{1}}{\prob{s = 1\Given\setAgt,\yk{1}}}.
\end{align} 
%
The second equality above is obtained by conditioning on $\yk{1}$ and taking the expectation over it. 

Conditioning on $\yk{1}$, the events in~\eqref{eq:out_5} are mutually independent. Furthermore, $\yk{2},\ldots,\yk{\Nt} $ are identically distributed. Hence, we get
%
\begin{multline}
\text{Pr}\brac{s=1\Given \setAgt, \yk{1}=x} = \indic{\yk{1}<1-\lambym}\left(\text{Pr}\brac{\yk{2}>\yk{1}+\lambym\Given\yk{1}=x}\right)^{k}\\\times \left(\text{Pr}\brac{\yk{k+2}>\yk{1}\given\yk{1}=x}\right)^{\Nt-k-1}.
\label{eq:out_6}
\end{multline}
%
Averaging~\eqref{eq:out_6} over $\yk{1}$ and writing the integral in terms of CCDF $\ccdfy{\cdot}$, we get 
\begin{equation}
\text{Pr}\brac{s=1\Given\setAgt} =\int_{0}^{1-\lambym}\left(F_{y}^{c}\left(x+\lambym\right)\right)^k \left(F_{y}^{c}\left(x\right)\right)^{\Nt-k-1}f_{y}(x)\,dx.
\label{eq:out_7}
\end{equation}
Using this probability in~\eqref{eq:out_3}  and simplifying the summation yields the desired interference-outage probability expression in~\eqref{eq:pr_outage_ccdf}.

We make the following observations about~\eqref{eq:pr_outage_ccdf}: (i) For the class of fading models with a continuous CCDF, $\outlam$ in~\eqref{eq:pr_outage_ccdf} is integral of a continuous and strictly decreasing  function in $\lam$.  Therefore, $\outlam$ is a continuous and strictly decreasing function of $\lam$. (ii) From~\eqref{eq:pr_outage_ccdf}  we see that $\outlam=\un$ when $\lam=0$ and $\outlam=0$ when $\lam=\cone$. Thus, by intermediate value theorem~\cite{Rudin_book}, for every $0\leq\outmax\leq\un$,  there exists a corresponding unique $\lam\in[0,\m]$ such that $\outlam=\outmax$. 
  

		

\subsection{Proof of Theorem~\ref{thm:selection_rule_on_off}}
\label{proof:selection_rule_on_off}
In order to prove that $\callamstarrule$ is optimal, we introduce the following terminology. First, we define a feasible selection rule to be a rule that satisfies the interference-outage constraint in~\eqref{eq:iop_cons}. Let $\F$ denote the set of all feasible rules. It is non-empty as the TAS rule that always selects antenna zero has an interference-outage probability of zero and is, therefore, feasible. Any TAS rule that violates~\eqref{eq:iop_cons} cannot be optimal. Thus, we can restrict our focus to the TAS rules in $\F$. We consider the two cases $\outmax\geq\un$ and $\outmax<\un$ separately below.

{\em $\outmax\geq\un$:} From the discussion in Comment 1 in Section~\ref{sec:lambda_rule}, the interference unconstrained rule $\caluncons$ is feasible and is the optimal rule. 

{\em $0\leq\outmax<\un$:} Here, the interference unconstrained rule is not even feasible. Therefore, it cannot even be considered. Instead, consider the TAS rule $\callamstarrule$, where $\lamstar$ is chosen such that the interference-outage probability of $\callamstarrule$ is equal to $\outmax$. From Lemma~\ref{lem:outage_Nt}, such a choice of $\lamstar$ always exists, is unique, and is strictly positive. Let $\sstar$ be the antenna selected by $\callamstarrule$. Then, among all the selection rules in $\F$, $\callamstarrule$, by the definition,  minimizes $\yk{{\sstar}} + \frac{\lamstar}{\cone}\gindic{{\sstar}}$, for any given realization of $\yk{1},\ldots,\yk{\Nt}$, and $\gk{1},\ldots,\gk{\Nt}$. Therefore, it also minimizes $\explow{\y,\g}{\yk{{\sstar}} + \frac{\lamstar}{\cone}\gindic{{\sstar}}}$. 

To prove that $\callamstarrule$ minimizes the average SEP among all the TAS rules in $\F$, we consider any feasible rule $\asrule\in\F$, such that  $s=\phi(\Hmx,\g)$. From above we know that   
\begin{equation}
\label{eq:opt_rul_1}  
   \explow{\y,\g}{\yk{{\sstar}} + \frac{\lamstar}{\cone}\gindic{{\sstar}}} \leq  \explow{\y,\g}{\yk{{s}} + \frac{\lamstar}{\cone}\gindic{{s}}}.
\end{equation}
Taking the expectations inside and using the fact that $\yk{i}={\SEP(\mathbf{\such}_{i})}/{\cone}$ and $\expect{\gindic{i}}=\prob{\gk{i}>\taubypt}$, we get
%
\begin{equation}
\label{eq:opt_rul_2}
   \explow{\Hmx,\g}{\SEP(\hsstar)} + \lamstar  \prob{\gk{\sstar}>\taubypt} \leq  \explow{\Hmx,\g}{\SEP(\hs)} + \lamstar  \prob{\gk{s}>\taubypt}.
\end{equation}
%
We know that $\prob{\gk{\sstar}>\taubypt}=\outmax$. By rearranging the terms, we get
%
\begin{equation}
\label{eq:ineq_3}
\explow{\Hmx,\g}{\SEP(\hsstar)} \leq \explow{\Hmx,\g}{\SEP(\hs)} + \lamstar \left( \prob{\gk{s}>\taubypt} -  \outmax \right).
\end{equation}
%
Since $\phi$ is a feasible rule, we know that $\prob{\gkgrtaubypt{s}}\leq \outmax$. As $\lamstar>0$,~\eqref{eq:ineq_3} implies that $\explow{\Hmx,\g}{\SEP(\hsstar)} \leq \explow{\Hmx,\g}{\SEP(\hs)}$ for any feasible rule $\phi$. Thus, $\callamstarrule$ is optimal.




\subsection{Proof of Theorem~\ref{thm:SEP_exact_Nt_gen}}
\label{proof:SEP_exact_Nt_gen}
We start with the probability of error conditioned on $\y$ and $\g$, which we denote by $\prob{\Err \given \y,\g}$. Using the law of total probability, it can be written as
%
\begin{equation}
\prob{\Err \given \y,\g} =  \prob{s=\nx,\Err\given\y,\g} + \sum_{i=1}^{\Nt}\prob{s=i,\Err\given\y,\g}.
\label{eq:Perr_all_h}
\end{equation}
%
Furthermore, $\prob{s=k,\Err\given\y,\g}=\prob{s=k\given\y,\g}\prob{\Err\given\y,\g,s=k}$, for $0\leq k \leq \Nt$. Averaging over $\y$ and $\g$ and exploiting the symmetry, $\avgSEP$ is given by
\begin{multline}
\label{eq:avg_SEP_1}
 \avgSEP = \explow{\y,\g}{\prob{s=\nx\given\y,\g}\prob{\Err\given\y,\g,s=\nx}} \\+ \Nt\explow{\y,\g}{\prob{s=1\given\y,\g}\prob{\Err\given\y,\g,s=1}}. 
\end{multline}

Given $s=0$ the SEP is equal to $\zerosep$.  Thus, $\prob{\Err\given\y,\g,s=\nx}=\zerosep$. Given $s=1$ the probability of error depends only on $\hk{1}$. Thus, by combining~\eqref{eq:isep} and~\eqref{eq:yi_def}, we get $\prob{\Err\given\y,\g,s=1}=\m \yk{1}$. Hence,
\begin{equation}
\label{eq:avg_SEP_3}
\avgSEP  = \zerosep \explow{\y,\g}{\prob{s=\nx\given\y,\g}} + \Nt\m\explow{\y,\g}{\yk{1}\prob{s=1\given\y,\g}}.
\end{equation}
From the law of total expectation, we know that $\explow{\y,\g}{\prob{s=\nx\given\y,\g}} = \prob{s = 0}$.
Similarly, 
\begin{equation}
\label{eq:avg_sep_3_one}
\explow{\y,\g}{\yk{1}\prob{s = 1\given \y,\g} } = \explow{\yk{1}}{\yk{1} \prob{s = 1\given \yk{1}}  }.
\end{equation}
Substituting these  two results into the average SEP expression in~\eqref{eq:avg_SEP_3}, we get
%
\begin{equation}
\label{eq:avg_SEP_4}
\avgSEP  = \termone + \termtwo,
\end{equation}
%
where $\termone=\zerosep \prob{s = 0}$ and $\termtwo=\Nt\m \explow{\yk{1}}{ \yk{1}\prob{s = 1\given \yk{1}}}$. We now evaluate $\termone$ and $\termtwo$.

{\em First Term $\termone$:}
From the selection rule $\callamstarrule$, we know that ${s=0}$ is selected when the antennas $1,\ldots,\Nt$ are outage-incompatible and their metrics exceed one. Therefore, $\termone$ can be written as 
\begin{align}
\termone &= \zerosep\prob{\gkgrtaubypt{1},\dots,\gkgrtaubypt{\Nt}, \yk{1}\!+\!\lamstarbym >1,\ldots,\yk{\Nt}\!+\!\lamstarbym >1},\\
&= \zerosep\left( \ccdfy{1-\lamstarbym}  \right)^{\Nt} {\un}^{\Nt}.
\label{eq:termone_a}
\end{align}
Here, the second equality follows as the channels are i.i.d and by substituting the CCDFs of $\yk{1}$ and $\gk{1}$.



{\em Second Term $\termtwo$}: From the law of total probability, we have 
%
\begin{equation}
\prob{s = 1\given \yk{1}} = \prob{s = 1,\gk{1}>\taubypt\Given\yk{1}}  + \prob{s = 1,\gk{1}\leq\taubypt\Given \yk{1}}. 
\label{eq:pr_s_1}
\end{equation}
%
Let  $\setAlt\define\left\{\left(\gklttaubypt{1}\right)\cap\setB \right\}$. Summing over all the events in which $k$ antennas out of the antennas $2,\ldots,\Nt$ are outage-compatible, we get in a manner similar to~\eqref{eq:out_3}:
\begin{multline}
\!\!\prob{s \!=\! 1\given \yk{1}}\! =\!\sum_{k=0}^{\Nt-1}\!\!\nck{\Nt-1}{k} 
\prob{s \!=\! 1 \Given \setAgt , \yk{1}} \prob{\setAgt}\\ + \sum_{k=0}^{\Nt-1}\nck{\Nt-1}{k}\prob{s = 1 \Given \setAlt, \yk{1}} \prob{\setAlt}. 
\label{eq:pr_s_1_2}
\end{multline}
% 
%Applying the chain rule, and using the fact that the STx-PRx channels are independent of $\yk{1}$, we get
%\begin{align} 
%\label{eq:prgrtaubypt}
%\prob{s = 1,\gkgrtaubypt{1},\setB\Given \yk{1}} &= 
%\prob{s = 1\Given\gkgrtaubypt{1},\setB, \yk{1}} \prob{\gkgrtaubypt{1},\setB},\\  
%\prob{s = 1,\gklttaubypt{1},\setB\Given \yk{1}} &= \prob{s = 1\Given \gklttaubypt{1},\setB,\yk{1}}\prob{\gklttaubypt{1},\setB}.
%\label{eq:prlttaubypt}
%\end{align}
%
Recall  the definition of the event  $\setAgt=\left\{\left(\gkgrtaubypt{1}\right)\cap\setB \right\}$ from Appendix~\ref{proof:outage_Nt}. The expression for $\prob{s = 1\given \setAgt, \yk{1}}$ is given in~\eqref{eq:out_6}.  The expression for $\prob{s = 1\given \setAlt, \yk{1}}$, can be derived along lines similar to that for $\prob{s = 1\given \setAgt, \yk{1}}$ in~\eqref{eq:out_6}. This yields   
\begin{equation}
\text{Pr}\brac{s =1\given \setAlt,\yk{1}=x} \!=\! F_{y}^{c}\brac{x}^{k}\left[\indic{x\leq\lamstarbym} +\indic{x>\lamstarbym}F_{y}^{c}\brac{x-\lamstarbym}^{\Nt-k-1}\right]
\label{eq:prob_gklt}
\end{equation}
%
Substituting $\prob{\setAgt}$ and~\eqref{eq:out_6} in~\eqref{eq:pr_s_1_2} simplifies the first part of~\eqref{eq:pr_s_1_2}. Similarly, using $\prob{\setAlt}=\left(1-\un\right)^{k+1}\un^{\Nt-k-1}$ and~\eqref{eq:prob_gklt} simplifies the second part of~\eqref{eq:pr_s_1_2}. Substituting $\prob{s = 1\given \yk{1}}$ from~\eqref{eq:pr_s_1_2} in $\explow{\yk{1}}{ \yk{1}\prob{s = 1\given \yk{1}}}$ and averaging over $\yk{1}$ yields the final expression of $\termtwo$ in~\eqref{eq:termtwo_gen}. 


\subsection{Proof of Theorem~\ref{thm:avg_SEP_imperfect}}
\label{proof:avg_SEP_imperfect_CSI}
The antenna $\shat$ selected by the optimal TAS rule in the presence of the channel estimation errors at the STx depends on $\yhatvec$ and $\ghatvec$. The SRx uses the perfect CSI of the STx-SRx link for the symbol detection. Thus, using the law of total probability the probability of error conditioned on $\y$, $\yhatvec$, and $\ghatvec$ can be written as
%
\begin{equation}
\prob{\Err \given \y,\yhatvec,\ghatvec} =  \prob{\shat=\nx,\Err\given \y, \yhatvec,\ghatvec} + \sum_{i=1}^{\Nt}\prob{\shat=i,\Err\given\y,\yhatvec,\ghatvec}.
\label{eq:Perr_all_imp_csi}
\end{equation}  
%
Now averaging over $\y$, $\yhatvec$, and $\ghatvec$ and simplifying further similar to the steps from~\eqref{eq:avg_SEP_1} to~\eqref{eq:avg_sep_3_one} in Appendix~\ref{proof:SEP_exact_Nt_gen} we get
%
\begin{equation}
\label{eq:avg_SEP_3_IMP_CSI}
\avgSEPhat  = \zerosep \prob{\shat=\nx} + \Nt\m\explow{\ykhat{1},\yk{1}}{\yk{1}\prob{\shat=1\given \ykhat{1}}}.
\end{equation}
%

First term in the above equation can be obtained by substituting the CCDFs of $\ykhat{1}$ and $\gkhat{1}$ in~\eqref{eq:termone_a}. The CCDF of $\ykhat{1}$ can be obtained by replacing $\snr$ with $\snrhat$ in~\eqref{eq:ccdfyNr} and the CCDF of $\gkhat{1}$ is $\unhat$. Now the expectation in the second term can be written as 
%
\newcommand{\Xhat}{\widehat{X}}
\newcommand{\xhat}{\hat{x}}
\begin{equation}
\label{eq:avg_SEP_4_IMP_CSI}
\explow{\ykhat{1},\yk{1}}{\yk{1}\prob{\shat=1\given \ykhat{1}}}= \int_{\xhat=0}^{1} \int_{x=0}^{1} x \prob{\shat=1\given \ykhat{1}=\xhat}  f_{\yk{1}\ykhat{1}}\left(x,\xhat\right)\,dx\,d\xhat,
\end{equation}
%
where $f_{\yk{1}\ykhat{1}}\left(\cdot,\cdot\right)$ is the joint PDF of the correlated RVs $\yk{1}$ and $\ykhat{1}$. From~\eqref{eq:yi_def} and~\eqref{eq:yihat_def}, we know that $\yk{1}$ and $\ykhat{1}$ are functions of the correlated gamma RVs $U\define\sumnr\hk{i1}$ and $V\define\sumnr\hkhat{i1}$, respectively. Thus, $f_{\yk{1}\ykhat{1}}\left(\cdot,\cdot\right)$ can be obtained by using variable transformation on the joint PDF of $U$ and $V$ given by 
%
\begin{multline}
\label{eq:bivargammaPDF}
f_{U,V}(u,v) = \frac{1}{(\Nr-1)!\left(1-\rhoh \right)\muh\muhhat }\left(\frac{uv}{\rhoh \muh\muhhat}\right)^{\frac{\Nr-1}{2}}\exp\left({-\frac{1}{(1-\rhoh)}\left( \frac{u}{\muh}+\frac{ v}{\muhhat}\right) } \right) \\ I_{\Nr-1}\left(\frac{2\sqrt{\rhoh uv}}{(1-\rhoh)\sqrt{\muh\muhhat}}\right),~\text{for}\; u,v>0.
\end{multline}
%
Using the joint PDF  $f_{\yk{1}\ykhat{1}}\left(\cdot,\cdot\right)$ in~\eqref{eq:avg_SEP_4_IMP_CSI}, we can simplify the integral over $x$ as below  
\begin{equation}
\label{eq:y1_jpdf}
\int_{x=0}^{1} x f_{\yk{1}\ykhat{1}}\left(x,\xhat\right)\,dx = \frac{T^{\Nr}}{(\Nr-1)!} \left(\ln\left(\frac{1}{\xhat} \right)\right)^{\Nr-1} \left(\xhat\right)^{\T\left(1 + \snrhatbyal \right) -1 },
\end{equation}
where $\T=\Tc$. Now, the second term can be simplified by substituting $\prob{\shat=1\given\ykhat{1}=\xhat}$. This can be obtained by replacing $\yk{1}$ and $\gk{1}$ from~\eqref{eq:pr_s_1} to~\eqref{eq:prob_gklt} in Appendix~\ref{proof:SEP_exact_Nt_gen} with $\ykhat{1}$ and $\gkhat{1}$ and their CCDFs. Finally, substituting the second term in~\eqref{eq:avg_SEP_3_IMP_CSI} yields the average SEP expression for imperfect CSI  in~\eqref{eq:avg_SEP_imperfect}.

\newcommand{\ccdfyrv}[1]{ F^{c}_{y}\left(#1 \right) }
\newcommand{\ccdfyhatrv}[1]{F^{c}_{\yhat}\left(#1 \right) }
\newcommand{\pdfy}[1]{ f_{y}\left( #1 \right) }
\newcommand{\pdfyhat}[1]{f_{\yhat}\left( #1 \right) }

\subsection{Proof of Theorem~\ref{thm:outage_imperfect_CSI}}
\label{proof:outage_imperfect_CSI}
Starting from~\eqref{eq:out_2} and using the law of total probability we get
\begin{equation}
\outhatlam=\Nt\text{Pr}\brac{\shat=1,\gk{1}>\taubypt,\gkhat{1}>\taubypt} + \Nt\text{Pr}\brac{\shat=1,\gk{1}>\taubypt,\gkhat{1}\leq\taubypt}.
\label{eq:outhat_2}
\end{equation}
Let $k$ be the number of antennas whose STx-PRx channel power gain estimates are below $\itau/\Pt$. Now we define $\setBhat=\left\{\gkhatlttaubypt{2},\dots,\gkhatlttaubypt{k+1},\gkhatgrtaubypt{k+2},\dots,\gkhatgrtaubypt{\Nt}\right\}$, $\setAgthat\define\left\{\left(\gkhatgrtaubypt{1}\right)\cap\setBhat \right\}$ and $\setAlthat\define\left\{\left(\gkhatlttaubypt{1}\right)\cap\setBhat \right\}$ similar to $\setB$, $\setAgt$, and $\setAlt$ in Appendix~\ref{proof:outage_Nt} and Appendix~\ref{proof:SEP_exact_Nt_gen}, respectively. Then, in similar lines to~\eqref{eq:pr_s_1_2} we can write~\eqref{eq:outhat_2}  as
%
\begin{multline}
\outhatlam = \Nt\sum_{k=0}^{\Nt-1} \nck{\Nt-1}{k} 
\prob{\shat = 1 \Given\gkgrtaubypt{1}, \setAgthat } \prob{\gkgrtaubypt{1},\setAgthat}\\ + \Nt\sum_{k=0}^{\Nt-1}\nck{\Nt-1}{k}\prob{\shat = 1 \Given \gkgrtaubypt{1},\setAlthat} \prob{\gkgrtaubypt{1},\setAlthat}. 
\label{eq:pr_s_1_2_imp}
\end{multline}
%
From the definition of $\shat$ in~\eqref{eq:shat} we know that selecting antenna one does not depend on $\gk{1}$. Thus, $\prob{\shat = 1 \Given\gkgrtaubypt{1},\setAgthat}=\prob{\shat = 1 \given \setAgthat}$  and $\prob{\shat = 1 \Given \gklttaubypt{1},\setAlthat}=\prob{\shat = 1 \given \setAlthat}$. The first term $\prob{\shat = 1 \given \setAgthat}$ can be obtained by replacing  $\ccdfyrv{.}$ and $\pdfy{.}$ with $\ccdfyhatrv{.}$ and $\pdfyhat{.}$ in~\eqref{eq:out_7}. The second term $\prob{\shat=1 \given \setAlthat}$ can be obtained by replacing $\ccdfyrv{.}$ with $\ccdfyhatrv{.}$ in~\eqref{eq:prob_gklt} and then averaging over $\yk{1}$. 

Now we know that  $\prob{\gkgrtaubypt{1},\setAgthat} =\prob{\gkgrtaubypt{1},\gkhatgrtaubypt{1}}\prob{\setB}$ and $\prob{\gkgrtaubypt{1},\setAlthat} =\prob{\gkgrtaubypt{1},\gkhatlttaubypt{1}}\prob{\setB}$. As $\gkhat{2},\ldots,\gkhat{\Nt}$ are i.i.d. we get $\prob{\setB}=\left(1- \unhat \right)^{k} \unhat^{\Nt-k-1} $. Now to simplify $\prob{\gkgrtaubypt{1},\gkhatlttaubypt{1}}$ we need the joint PDF of the two correlated exponential RVs. This can be obtained by substituting $\Nr=1$ in~\eqref{eq:bivargammaPDF}. Then, integrating it over appropriate limits we get 
\begin{equation}
\prob{\gkgrtaubypt{1},\gkhatlttaubypt{1}} =  \un Q_1\left(\frac{\rhog}{ \gpilotpower} \sqrt{\frac{2\itau}{ \gpilotpower\Pt}},\sqrt{\frac{2 \gpilotpower\itau}{\Pt}}\right)  - \frac{\unhat}{2} \left( 1 + e^{-\frac{2\itau\rhog}{ \gpilotpower\Pt}}I_{0}\left(\frac{2\itau\rhog}{ \gpilotpower\Pt} \right) \right).
\end{equation}
We can get $\prob{\gkgrtaubypt{1},\gkhatgrtaubypt{1}}$ using $\prob{\gkgrtaubypt{1},\gkhatgrtaubypt{1}}= \prob{\gkgrtaubypt{1}} - \prob{\gkgrtaubypt{1},\gkhatlttaubypt{1}} $. Substituting these probability terms in~\eqref{eq:pr_s_1_2_imp} yields final expression for $\outhatlam$ in~\eqref{eq:pr_outage_impefect}

\bibliographystyle{IEEEtran}
\bibliography{../../../Bibtex/bibJournalList,../../../Bibtex/standard,../../../Bibtex/sarvendra,../../../Bibtex/IEEE_papers,../../../Bibtex/mimo,../../../Bibtex/salil,../../../Bibtex/book}


%\bibliography{../../../Bibtex/sarvendra,../../../Bibtex/IEEE_papers}


\end{document}


